{"config":{"title":"Aquarium Yeast Display","description":"A workflow for doing several types of yeast display experiments with Aquarium","copyright":"University of Washington","version":"0.0.1","authors":[{"name":"Devin Strickland","affiliation":"University of Washington"},{"name":"Sarah Goldberg","affilation":"","affiliation":"University of Washington"},{"name":"Abe Miller","affilation":"","affiliation":"University of Washington"}],"maintainer":{"name":"Devin Strickland","email":"dvn.strcklnd@gmail.com"},"acknowledgements":[{"name":"Sam Halabiya","affiliation":"University of Washington"},{"name":"Cami Cordray","affilation":"","affiliation":"University of Washington"}],"github":{"user":"dvnstrcklnd","repo":"aq-yeast-display"},"keywords":null,"aquadoc_version":"1.0.2","aquarium_version":"\u003c%= Bioturk::Application.config.aquarium_version %\u003e"},"components":[{"sample_types":[{"id":70,"name":"DNA Library","description":"A sample that contains a pool of DNA molecules with many unique sequences","created_at":"2018-01-02T14:28:12.000-08:00","updated_at":"2018-01-02T14:28:12.000-08:00","field_types":[{"id":3965,"parent_id":70,"name":"Oligo Pool","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2018-06-05T14:45:01.000-07:00","updated_at":"2018-06-05T14:45:01.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1772,"field_type_id":3965,"sample_type_id":75,"object_type_id":null,"created_at":"2018-06-05T14:45:01.000-07:00","updated_at":"2018-06-05T14:45:01.000-07:00","sample_type":{"id":75,"name":"Oligo Pool","description":"Pool or library of ssDNA oligos. May contain one or more sublibraries. In array fields, the n-th position corresponds to n-th sublibrary. \"forward priming site\" and \"reverse priming site\" are read as primer sequences.","created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2019-01-23T16:24:45.000-08:00"}}],"sample_types":["Oligo Pool"],"object_types":[null]}]},{"id":75,"name":"Oligo Pool","description":"Pool or library of ssDNA oligos. May contain one or more sublibraries. In array fields, the n-th position corresponds to n-th sublibrary. \"forward priming site\" and \"reverse priming site\" are read as primer sequences.","created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2019-01-23T16:24:45.000-08:00","field_types":[{"id":3947,"parent_id":75,"name":"Manufacturer","ftype":"string","choices":null,"array":false,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-07T09:48:57.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3948,"parent_id":75,"name":"Oligo Library ID","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-07T09:48:57.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3949,"parent_id":75,"name":"inner forward primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1763,"field_type_id":3949,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3950,"parent_id":75,"name":"inner reverse primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1764,"field_type_id":3950,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3951,"parent_id":75,"name":"sublibrary forward primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1765,"field_type_id":3951,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3952,"parent_id":75,"name":"sublibrary reverse primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1766,"field_type_id":3952,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3953,"parent_id":75,"name":"min length (nt) (array)","ftype":"number","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3954,"parent_id":75,"name":"max length (nt) (array)","ftype":"number","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3955,"parent_id":75,"name":"variants (array)","ftype":"number","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3964,"parent_id":75,"name":"sublibrary name (array)","ftype":"string","choices":null,"array":true,"required":true,"created_at":"2018-06-05T14:37:16.000-07:00","updated_at":"2018-06-05T14:37:16.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":7477,"parent_id":75,"name":"forward priming site (array)","ftype":"string","choices":null,"array":true,"required":true,"created_at":"2019-01-23T16:24:45.000-08:00","updated_at":"2019-01-23T16:24:45.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":7478,"parent_id":75,"name":"reverse priming site (array)","ftype":"string","choices":null,"array":true,"required":true,"created_at":"2019-01-23T16:24:45.000-08:00","updated_at":"2019-01-23T16:24:45.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]}]},{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00","field_types":[{"id":1,"parent_id":1,"name":"Overhang Sequence","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":2,"parent_id":1,"name":"Anneal Sequence","ftype":"string","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3,"parent_id":1,"name":"T Anneal","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]}]}],"object_types":[{"id":747,"name":"Labeled Yeast Library Suspension","description":"Yeast library labeled with dye-conjugated antibody (e.g., anti-Myc-FITC)","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2018-01-02T14:30:54.000-08:00","updated_at":"2018-01-02T14:30:54.000-08:00","unit":"DNA Library","cost":0.01,"release_method":"return","release_description":"","sample_type_id":70,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"DNA Library"},{"id":748,"name":"Yeast Library Liquid Culture","description":"A special case of yeast culture that contains a strain library","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2018-01-02T14:33:08.000-08:00","updated_at":"2018-01-02T14:33:08.000-08:00","unit":"DNA Library","cost":0.01,"release_method":"return","release_description":"","sample_type_id":70,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"DNA Library"},{"id":750,"name":"Yeast Library in Soln 1","description":"concentrated yeast DNA library sample stored in Zymoprep solution 1, in -80","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2018-01-11T14:47:26.000-08:00","updated_at":"2018-02-15T08:47:21.000-08:00","unit":"DNA Library","cost":0.01,"release_method":"return","release_description":"","sample_type_id":70,"image":"","prefix":"M80","rows":null,"columns":null,"sample_type_name":"DNA Library"}],"operation_type":{"name":"Store Yeast Library Sample","category":"Next Gen Prep","deployed":false,"on_the_fly":false,"field_types":[{"ftype":"sample","role":"input","name":"Yeast Culture","sample_types":["DNA Library","DNA Library"],"object_types":["Labeled Yeast Library Suspension","Yeast Library Liquid Culture"],"part":false,"array":false,"routing":"Y","preferred_operation_type_id":368,"preferred_field_type_id":1619,"choices":null},{"ftype":"sample","role":"output","name":"Stored sample rep 1","sample_types":["DNA Library"],"object_types":["Yeast Library in Soln 1"],"part":false,"array":false,"routing":"Y","preferred_operation_type_id":null,"preferred_field_type_id":null,"choices":null},{"ftype":"sample","role":"output","name":"Stored sample rep 2","sample_types":["DNA Library"],"object_types":["Yeast Library in Soln 1"],"part":false,"array":false,"routing":"Y","preferred_operation_type_id":null,"preferred_field_type_id":null,"choices":null}],"protocol":"\n# SG\n# Refactored by Devin Strickland 2/17/18\n\nneeds \"Standard Libs/Debug\"\nneeds \"Yeast Display/YeastDisplayHelper\"\nneeds \"Yeast Display/YeastDisplayShows\"\n\nclass Protocol\n    \n    include Debug, YeastDisplayHelper, YeastDisplayShows\n    \n    attr_accessor :low_growth_ops, :ready_ops\n\n    INPUT = \"Yeast Culture\"\n    OUTPUT_PREFIX = \"Stored sample rep\"\n    OUTPUT_1 = \"#{OUTPUT_PREFIX} 1\"\n    OUTPUT_2 = \"#{OUTPUT_PREFIX} 2\"\n    \n    MIN_OD = 0.2\n    \n    OD_ML_NEEDED = 9.0\n    NUMBER_OF_REPLICATES = 2 # 2 stored samples for each input\n    CENTRIFUGE_TUBE = \"15 ml \u003cb\u003epolypropylene\u003c/b\u003e tube\"\n    CENTRIFUGE_TIME = 5 # min\n    CENTRIFUGE_G = 4696 # g\n    RESUSPENSION_BUFFER = \"Zymoprep Digestion Buffer (Solution 1)\"\n    RESUSPENSION_VOL = { qty: 200, units: 'µl'}\n    CONCENTRATED_VOL = { qty: 225, units: 'µl'}\n    \n\n    def main   \n        \n        operations.running.retrieve\n        \n        set_od_ml_needed\n        \n        measure_ods\n            \n        @low_growth_ops, @ready_ops = partition_ops_by_growth\n        \n        put_back\n        \n        return {} unless @ready_ops.present?\n        \n        gather_additional_materials\n        \n        # TODO: should only make ready operations\n        # since i push some back to pending, i shouldnt make the outputs to those operations\n        \n        \n        pushed_back = false\n        pushed_back = check_volumes\n        @ready_ops.make\n        \n        if @ready_ops.length \u003e 0\n        \n          spin_down\n          \n          resuspend\n          \n          clean_up pushed_back\n          \n          @ready_ops.store\n          \n          # if post-sort, save bin info\n          @ready_ops.each { |op|\n              if( !(op.input(INPUT).item.get(:bin).nil?) ) # sorted sample\n                  op.output(OUTPUT_1).item.associate(:bin, op.input(INPUT).item.get(:bin))\n                  op.output(OUTPUT_2).item.associate(:bin, op.input(INPUT).item.get(:bin))\n              end\n          }\n        else \n          clean_up_pushed_back\n        end\n          \n        return {} \n        \n    end\n    \n    def set_od_ml_needed\n        set_test_od_mls if debug\n        \n        operations.each do |op|\n            op.associate(:od_ml_needed, OD_ML_NEEDED) unless op.associations[:od_ml_needed]\n        end\n    end\n    \n    def gather_additional_materials\n        min_resuspension_vol = RESUSPENSION_VOL[:qty] * NUMBER_OF_REPLICATES * @ready_ops.length\n        \n        show do\n            title \"You will also need\"\n            check \"#{self.ready_ops.length} #{CENTRIFUGE_TUBE}(s)\"\n            check \"#{RESUSPENSION_BUFFER} (#{min_resuspension_vol} #{RESUSPENSION_VOL[:units]})\"\n            warning \"Make sure you take polypropylene and not polystyrene tubes!\"\n        end\n    end\n    \n    def measure_ods\n        unique_culture_operations = operations.uniq { |op| op.input(INPUT).item }.extend(OperationList)\n        \n        measure_culture_ods(unique_culture_operations)\n        \n        set_test_ods if debug\n        \n        unique_culture_operations.each { |op| op.set_input_data(INPUT, :od, op.temporary[:od]) }\n    end\n    \n    def partition_ops_by_growth\n        operations.running.each do |op|\n            op.temporary[:growth] = op.input(INPUT).item.get(:od).to_f \u003c MIN_OD ? :low_growth : :ready \n        end\n        \n        grouped_ops = operations.running.group_by { |op| op.temporary[:growth] }\n        \n        [grouped_ops[:low_growth], grouped_ops[:ready]]\n    end\n    \n    def put_back\n        return unless @low_growth_ops.present?\n        \n        @low_growth_ops.each { |op| op.change_status(\"pending\") }\n        \n        show do\n            title \"Return low-growth cultures to shaker\"\n            \n            note \"Return the following cultures to the shaker for additional growth:\"\n            table self.low_growth_ops.start_table\n              .input_item(INPUT)\n              .end_table\n        end\n    end\n    \n    def spin_down\n        show do\n            title \"Transfer cultures\"\n            \n            note \"Get #{self.ready_ops.length} #{CENTRIFUGE_TUBE}s.\"\n            note \"Label the tubes according to the #{INPUT} column in the table.\"\n            note \"Transfer the indicated volume of each culture to the corresponding tube:\"\n            table self.ready_ops.start_table\n              .input_item(INPUT)\n              .custom_column(heading: \"Culture (ml)\", checkable: true) { |op| library_culture_volume(op).round(1) }\n              .end_table\n        end\n        \n        show do\n            title \"Spin down cultures\"\n            \n            check \"Centrifuge the #{CENTRIFUGE_TUBE}(s) for #{CENTRIFUGE_TIME} min at #{CENTRIFUGE_G} g\"\n            warning \"Make sure tubes are balanced!\"\n            check \"Pour off supernatant. Knock tube(s) on a kimwipe to dry remaining liquid.\"\n        end\n    end\n    \n    def resuspend\n        vol_to_add = NUMBER_OF_REPLICATES * RESUSPENSION_VOL[:qty]\n        \n        show do\n            title \"Resuspend and aliquot cells\"\n            \n            check \"Add #{vol_to_add} #{RESUSPENSION_VOL[:units]} of #{RESUSPENSION_BUFFER} to each #{CENTRIFUGE_TUBE}.\"\n            check \"Vortex each #{CENTRIFUGE_TUBE} until cells are fully resuspended.\"\n            note \"Label 1.5 mL tubes according to the \u003cb\u003e#{NUMBER_OF_REPLICATES}\u003c/b\u003e #{OUTPUT_PREFIX} columns in the table.\"\n            note \"Transfer #{qty_display(CONCENTRATED_VOL)} from each resuspended #{INPUT} to the labeled tubes according to the table.\"\n            \n            table self.ready_ops.start_table\n                .input_item(INPUT)\n                .output_item(OUTPUT_1, checkable: true)\n                .output_item(OUTPUT_2, checkable: true)\n                .end_table\n        end\n    end \n    \n    def clean_up pushed_back\n        @ready_ops.each { |op| op.input(INPUT).item.mark_as_deleted }\n        \n        show do\n            title \"Cleanup\"\n            \n            check \"Dispose of any input sample cultures remaining on bench.\"\n            check \"Return the #{RESUSPENSION_BUFFER} to the kit.\"\n            \n            if pushed_back\n                note \"Please notify a lab manager that one or more of the operations were pushed back to pending\"\n            end\n        end\n    end\n    \n    def library_culture_volume(op)\n        NUMBER_OF_REPLICATES * op.associations[:od_ml_needed].to_f / (op.input(INPUT).item.get(:od) * 10.0)\n    end\n    \n    def set_test_od_mls\n        test_od_mls = [0.89, 4.5, 3.0, 2.0, 1.33]\n        operations.running.each { |op| op.associate(:od_ml_needed, test_od_mls.rotate![0]) }\n    end\n    \n    def set_test_ods\n        test_ods = [0.3] #[0.5, 0.15, 0.3, 0.4, 0.2]\n        operations.running.each { |op| op.temporary[:od] = test_ods.rotate![0] }\n    end\n    \n    def check_volumes\n        \n    # ask tech if there is enough volume\n      vol_checking = show do \n        title \"Checking Volumes\"\n        operations.each do |op|\n           select [\"Yes\", \"No\"], var: \"#{op.input(\"Yeast Culture\").item.id}\", label: \"Does #{op.input(\"Yeast Culture\").item.id} have at least #{library_culture_volume(op).round(1)} mL?\", default: 0\n        end\n      end\n        \n      low_vol_ops_items = []  \n      operations.each do |op|\n        if vol_checking[\"#{op.input(\"Yeast Culture\").item.id}\".to_sym] == \"No\"\n          # delete the op from ready_ops, so we don't keep using this operation later on.\n          # for example, we shouldn't delete the inputs for this operation.\n          @ready_ops.delete(op)\n          op.change_status(\"pending\")\n          low_vol_ops_items.push(op.input(\"Yeast Culture\").item.id)\n          #op.error :not_enough_volume, \"#{op.input(\"Yeast Culture\").item.id} didn't have enough volume. Please talk to the lab manager.\"\n        end\n      end\n      \n     # ask the tech to add SDO -His-Trp-Ura to items w/o enough volume and return to shaker\n        if low_vol_ops_items.length \u003e 0  \n          show do\n            title \"Add solution and return to shaker\"\n            \n            note \"For each item in #{low_vol_ops_items}, adding 1ml of SDO -His-Trp-Ura and return to 30c shaker\"\n          end\n        end\n      \n      return low_vol_ops_items.length \u003e 0\n        \n    end\n    \n    def clean_up_pushed_back\n      show do\n        title \"No More Operations\"\n        \n         note \"Please notify a lab manager that one or more of the operations were pushed back to pending\"\n      end\n    end\n    \nend","precondition":"def precondition(_op)\n  true\nend","cost_model":"def cost(_op)\n  { labor: 12.06, materials: 0.27 }\nend","documentation":"Step 1 in preparation of yeast DNA library samples for NGS. \nFull flow is:\n1. Store concentrated  sample in Zymoprep Solution 1, in -80\n2. Zymoprep sample and clean\n3. Exonuclease digestion and purification of sample\n4. qPCR to amplify, clean up, using pETCON adapters \n5. qPCR to amplify and add illumina adapters","test":"","timing":null}},{"sample_types":[{"id":5,"name":"Yeast Strain","description":"A strain of yeast distinguished from others by genomic or plasmid modifications","created_at":"2013-10-16T14:37:29.000-07:00","updated_at":"2015-12-08T17:40:57.000-08:00","field_types":[{"id":18,"parent_id":5,"name":"Parent","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-25T08:43:19.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":8,"field_type_id":18,"sample_type_id":5,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":5,"name":"Yeast Strain","description":"A strain of yeast distinguished from others by genomic or plasmid modifications","created_at":"2013-10-16T14:37:29.000-07:00","updated_at":"2015-12-08T17:40:57.000-08:00"}}],"sample_types":["Yeast Strain"],"object_types":[null]},{"id":19,"parent_id":5,"name":"Integrant","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":9,"field_type_id":19,"sample_type_id":2,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":2,"name":"Plasmid","description":"A circular piece of double stranded DNA","created_at":"2013-10-15T09:59:25.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":10,"field_type_id":19,"sample_type_id":4,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Plasmid","Fragment"],"object_types":[null,null]},{"id":20,"parent_id":5,"name":"Plasmid","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":11,"field_type_id":20,"sample_type_id":2,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":2,"name":"Plasmid","description":"A circular piece of double stranded DNA","created_at":"2013-10-15T09:59:25.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Plasmid"],"object_types":[null]},{"id":21,"parent_id":5,"name":"Integrated Marker(s)","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":22,"parent_id":5,"name":"Plasmid Marker(s)","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":23,"parent_id":5,"name":"Mating Type","ftype":"string","choices":"MATa,MATalpha,Diploid","array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-10T09:05:01.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":24,"parent_id":5,"name":"QC Primer1","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":12,"field_type_id":24,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":25,"parent_id":5,"name":"QC Primer2","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":13,"field_type_id":25,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":43,"parent_id":5,"name":"QC_length","ftype":"number","choices":"","array":false,"required":false,"created_at":"2016-05-20T14:29:39.000-07:00","updated_at":"2016-05-20T14:35:37.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":44,"parent_id":5,"name":"Comp_cell_limit","ftype":"string","choices":"Yes,No","array":false,"required":false,"created_at":"2016-05-20T14:35:37.000-07:00","updated_at":"2016-05-20T14:35:37.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":83,"parent_id":5,"name":"Media","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2017-07-12T19:25:25.000-07:00","updated_at":"2017-07-12T19:25:25.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":954,"parent_id":5,"name":"Has this strain passed QC?","ftype":"string","choices":"No,Yes","array":false,"required":false,"created_at":"2017-10-31T11:39:27.000-07:00","updated_at":"2017-10-31T20:14:46.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":6455,"parent_id":5,"name":"Haploids","ftype":"sample","choices":null,"array":true,"required":false,"created_at":"2018-10-24T19:01:40.000-07:00","updated_at":"2018-10-24T19:01:40.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":2669,"field_type_id":6455,"sample_type_id":5,"object_type_id":null,"created_at":"2018-10-24T19:01:40.000-07:00","updated_at":"2018-10-24T19:01:40.000-07:00","sample_type":{"id":5,"name":"Yeast Strain","description":"A strain of yeast distinguished from others by genomic or plasmid modifications","created_at":"2013-10-16T14:37:29.000-07:00","updated_at":"2015-12-08T17:40:57.000-08:00"}}],"sample_types":["Yeast Strain"],"object_types":[null]}]},{"id":2,"name":"Plasmid","description":"A circular piece of double stranded DNA","created_at":"2013-10-15T09:59:25.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00","field_types":[{"id":4,"parent_id":2,"name":"Sequence","ftype":"url","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:30:08.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":5,"parent_id":2,"name":"Sequence Verification","ftype":"url","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:16:33.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":6,"parent_id":2,"name":"Bacterial Marker","ftype":"string","choices":"Amp,Kan,Amp + Kan,Spec,Kan + Spec,Chlor,Tet,NA,Other","array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2017-12-27T11:26:31.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":7,"parent_id":2,"name":"Yeast Marker","ftype":"string","choices":"HIS,TRP,URA,LEU,NatMX,KanMX,HygMX,BleoMX,5FOA,NA,Other","array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2017-02-13T10:49:58.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":27,"field_type_id":7,"sample_type_id":1,"object_type_id":null,"created_at":"2017-02-13T10:49:58.000-08:00","updated_at":"2017-02-13T10:49:58.000-08:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":8,"parent_id":2,"name":"Length","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:16:33.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":42,"parent_id":2,"name":"Sequencing Primers","ftype":"sample","choices":null,"array":true,"required":false,"created_at":"2016-05-09T21:30:48.000-07:00","updated_at":"2016-05-09T21:30:48.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":26,"field_type_id":42,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T21:30:48.000-07:00","updated_at":"2016-05-09T21:30:48.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":46,"parent_id":2,"name":"QC Primer1","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":29,"field_type_id":46,"sample_type_id":1,"object_type_id":null,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":47,"parent_id":2,"name":"QC Primer2","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":30,"field_type_id":47,"sample_type_id":1,"object_type_id":null,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":48,"parent_id":2,"name":"QC_length","ftype":"number","choices":null,"array":false,"required":false,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":5816,"parent_id":2,"name":"Transformation Temperature","ftype":"number","choices":"37,30","array":false,"required":false,"created_at":"2018-09-17T15:02:22.000-07:00","updated_at":"2018-11-06T11:31:23.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":16203,"parent_id":2,"name":"Comp Cells","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2020-02-14T10:28:40.000-08:00","updated_at":"2020-02-14T10:28:40.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":3108,"field_type_id":16203,"sample_type_id":3,"object_type_id":null,"created_at":"2020-02-14T10:28:40.000-08:00","updated_at":"2020-02-14T10:28:40.000-08:00","sample_type":{"id":3,"name":"E coli strain","description":"A strain of E coli distinguished from others by genomic (not plasmid) modifications.","created_at":"2013-10-15T10:16:52.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["E coli strain"],"object_types":[null]}]},{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00","field_types":[{"id":1,"parent_id":1,"name":"Overhang Sequence","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":2,"parent_id":1,"name":"Anneal Sequence","ftype":"string","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3,"parent_id":1,"name":"T Anneal","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]}]},{"id":3,"name":"E coli strain","description":"A strain of E coli distinguished from others by genomic (not plasmid) modifications.","created_at":"2013-10-15T10:16:52.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00","field_types":[{"id":10,"parent_id":3,"name":"Parent","ftype":"sample","choices":null,"array":null,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1,"field_type_id":10,"sample_type_id":3,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":3,"name":"E coli strain","description":"A strain of E coli distinguished from others by genomic (not plasmid) modifications.","created_at":"2013-10-15T10:16:52.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["E coli strain"],"object_types":[null]}]},{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00","field_types":[{"id":11,"parent_id":4,"name":"Sequence","ftype":"url","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:17:39.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":12,"parent_id":4,"name":"Length","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:17:39.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":13,"parent_id":4,"name":"Template","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-12T19:07:59.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":2,"field_type_id":13,"sample_type_id":2,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":2,"name":"Plasmid","description":"A circular piece of double stranded DNA","created_at":"2013-10-15T09:59:25.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":3,"field_type_id":13,"sample_type_id":3,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":3,"name":"E coli strain","description":"A strain of E coli distinguished from others by genomic (not plasmid) modifications.","created_at":"2013-10-15T10:16:52.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":4,"field_type_id":13,"sample_type_id":4,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":5,"field_type_id":13,"sample_type_id":5,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":5,"name":"Yeast Strain","description":"A strain of yeast distinguished from others by genomic or plasmid modifications","created_at":"2013-10-16T14:37:29.000-07:00","updated_at":"2015-12-08T17:40:57.000-08:00"}},{"id":2547,"field_type_id":13,"sample_type_id":70,"object_type_id":null,"created_at":"2018-09-18T16:02:54.000-07:00","updated_at":"2018-09-18T16:02:54.000-07:00","sample_type":{"id":70,"name":"DNA Library","description":"A sample that contains a pool of DNA molecules with many unique sequences","created_at":"2018-01-02T14:28:12.000-08:00","updated_at":"2018-01-02T14:28:12.000-08:00"}}],"sample_types":["Plasmid","E coli strain","Fragment","Yeast Strain","DNA Library"],"object_types":[null,null,null,null,null]},{"id":14,"parent_id":4,"name":"Forward Primer","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-12T19:07:59.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":6,"field_type_id":14,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":2664,"field_type_id":14,"sample_type_id":4,"object_type_id":null,"created_at":"2018-10-22T13:03:32.000-07:00","updated_at":"2018-10-22T13:03:32.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer","Fragment"],"object_types":[null,null]},{"id":15,"parent_id":4,"name":"Reverse Primer","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-12T19:07:59.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":7,"field_type_id":15,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":2665,"field_type_id":15,"sample_type_id":4,"object_type_id":null,"created_at":"2018-10-22T13:03:32.000-07:00","updated_at":"2018-10-22T13:03:32.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer","Fragment"],"object_types":[null,null]},{"id":16,"parent_id":4,"name":"Restriction Enzyme(s)","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:17:39.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":17,"parent_id":4,"name":"Yeast Marker","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:17:39.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":6423,"parent_id":4,"name":"Fragment Mix Array","ftype":"sample","choices":null,"array":true,"required":false,"created_at":"2018-10-23T13:35:15.000-07:00","updated_at":"2018-10-24T11:05:59.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":2667,"field_type_id":6423,"sample_type_id":1,"object_type_id":null,"created_at":"2018-10-23T13:35:15.000-07:00","updated_at":"2018-10-23T13:35:15.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":2668,"field_type_id":6423,"sample_type_id":4,"object_type_id":null,"created_at":"2018-10-23T13:35:15.000-07:00","updated_at":"2018-10-23T13:35:15.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer","Fragment"],"object_types":[null,null]}]},{"id":70,"name":"DNA Library","description":"A sample that contains a pool of DNA molecules with many unique sequences","created_at":"2018-01-02T14:28:12.000-08:00","updated_at":"2018-01-02T14:28:12.000-08:00","field_types":[{"id":3965,"parent_id":70,"name":"Oligo Pool","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2018-06-05T14:45:01.000-07:00","updated_at":"2018-06-05T14:45:01.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1772,"field_type_id":3965,"sample_type_id":75,"object_type_id":null,"created_at":"2018-06-05T14:45:01.000-07:00","updated_at":"2018-06-05T14:45:01.000-07:00","sample_type":{"id":75,"name":"Oligo Pool","description":"Pool or library of ssDNA oligos. May contain one or more sublibraries. In array fields, the n-th position corresponds to n-th sublibrary. \"forward priming site\" and \"reverse priming site\" are read as primer sequences.","created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2019-01-23T16:24:45.000-08:00"}}],"sample_types":["Oligo Pool"],"object_types":[null]}]},{"id":75,"name":"Oligo Pool","description":"Pool or library of ssDNA oligos. May contain one or more sublibraries. In array fields, the n-th position corresponds to n-th sublibrary. \"forward priming site\" and \"reverse priming site\" are read as primer sequences.","created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2019-01-23T16:24:45.000-08:00","field_types":[{"id":3947,"parent_id":75,"name":"Manufacturer","ftype":"string","choices":null,"array":false,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-07T09:48:57.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3948,"parent_id":75,"name":"Oligo Library ID","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-07T09:48:57.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3949,"parent_id":75,"name":"inner forward primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1763,"field_type_id":3949,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3950,"parent_id":75,"name":"inner reverse primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1764,"field_type_id":3950,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3951,"parent_id":75,"name":"sublibrary forward primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1765,"field_type_id":3951,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3952,"parent_id":75,"name":"sublibrary reverse primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1766,"field_type_id":3952,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3953,"parent_id":75,"name":"min length (nt) (array)","ftype":"number","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3954,"parent_id":75,"name":"max length (nt) (array)","ftype":"number","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3955,"parent_id":75,"name":"variants (array)","ftype":"number","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3964,"parent_id":75,"name":"sublibrary name (array)","ftype":"string","choices":null,"array":true,"required":true,"created_at":"2018-06-05T14:37:16.000-07:00","updated_at":"2018-06-05T14:37:16.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":7477,"parent_id":75,"name":"forward priming site (array)","ftype":"string","choices":null,"array":true,"required":true,"created_at":"2019-01-23T16:24:45.000-08:00","updated_at":"2019-01-23T16:24:45.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":7478,"parent_id":75,"name":"reverse priming site (array)","ftype":"string","choices":null,"array":true,"required":true,"created_at":"2019-01-23T16:24:45.000-08:00","updated_at":"2019-01-23T16:24:45.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]}]},{"id":67,"name":"Protease","description":"An enzyme that digests other proteins","created_at":"2017-12-18T12:10:34.000-08:00","updated_at":"2017-12-18T12:10:34.000-08:00","field_types":[{"id":1466,"parent_id":67,"name":"Incubation buffer id","ftype":"number","choices":null,"array":false,"required":false,"created_at":"2017-12-18T12:10:34.000-08:00","updated_at":"2017-12-18T12:10:34.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":1467,"parent_id":67,"name":"Quench buffer id","ftype":"number","choices":null,"array":false,"required":false,"created_at":"2017-12-18T12:10:34.000-08:00","updated_at":"2017-12-18T12:10:34.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]}]},{"id":84,"name":"Biotinylated Binding Target","description":"A protein sample that has been biotinylated for detection with SAPE","created_at":"2019-09-14T17:35:04.000-07:00","updated_at":"2019-09-14T17:35:04.000-07:00","field_types":[{"id":12997,"parent_id":84,"name":"Incubation buffer","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2019-09-14T17:35:04.000-07:00","updated_at":"2019-09-14T17:35:04.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":2985,"field_type_id":12997,"sample_type_id":69,"object_type_id":null,"created_at":"2019-09-14T17:35:04.000-07:00","updated_at":"2019-09-14T17:35:04.000-07:00","sample_type":{"id":69,"name":"Assay Buffer","description":"A buffer that is tailored to a specific type of assay or experiment","created_at":"2017-12-18T15:09:05.000-08:00","updated_at":"2017-12-18T15:09:05.000-08:00"}}],"sample_types":["Assay Buffer"],"object_types":[null]}]},{"id":69,"name":"Assay Buffer","description":"A buffer that is tailored to a specific type of assay or experiment","created_at":"2017-12-18T15:09:05.000-08:00","updated_at":"2017-12-18T15:09:05.000-08:00","field_types":[]},{"id":68,"name":"Antibody","description":"Used to label other proteins","created_at":"2017-12-18T12:14:35.000-08:00","updated_at":"2017-12-18T12:14:35.000-08:00","field_types":[{"id":1468,"parent_id":68,"name":"Binding buffer id","ftype":"number","choices":null,"array":false,"required":false,"created_at":"2017-12-18T12:14:35.000-08:00","updated_at":"2017-12-18T12:14:35.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]}]}],"object_types":[{"id":428,"name":"Yeast 50ml culture","description":"Culture for making comp cells","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2014-07-30T15:07:45.000-07:00","updated_at":"2014-08-12T19:17:15.000-07:00","unit":"Yeast Strain","cost":0.01,"release_method":"dispose","release_description":"","sample_type_id":5,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"Yeast Strain"},{"id":748,"name":"Yeast Library Liquid Culture","description":"A special case of yeast culture that contains a strain library","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2018-01-02T14:33:08.000-08:00","updated_at":"2018-01-02T14:33:08.000-08:00","unit":"DNA Library","cost":0.01,"release_method":"return","release_description":"","sample_type_id":70,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"DNA Library"},{"id":742,"name":"Protease Stock","description":"Protease at stock concentration","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2017-12-18T12:12:45.000-08:00","updated_at":"2017-12-18T12:12:45.000-08:00","unit":"Protease","cost":0.01,"release_method":"return","release_description":"","sample_type_id":67,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"Protease"},{"id":847,"name":"Biotinylated Binding Target Stock","description":"Biotinylated Binding Target at stock concentration","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2019-09-14T17:35:59.000-07:00","updated_at":"2019-09-14T17:35:59.000-07:00","unit":"Biotinylated Binding Target","cost":0.01,"release_method":"return","release_description":"","sample_type_id":84,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"Biotinylated Binding Target"},{"id":743,"name":"Antibody Stock","description":"An antibody at stock concentration","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2017-12-18T12:16:06.000-08:00","updated_at":"2017-12-18T15:46:26.000-08:00","unit":"Antibody","cost":0.01,"release_method":"return","release_description":"","sample_type_id":68,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"Antibody"},{"id":741,"name":"Labeled Yeast Strain Suspension","description":"A yeast strain that has been labeled for flow cytometry","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2017-12-18T12:05:31.000-08:00","updated_at":"2017-12-18T12:05:31.000-08:00","unit":"Yeast Strain","cost":0.01,"release_method":"return","release_description":"","sample_type_id":5,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"Yeast Strain"},{"id":747,"name":"Labeled Yeast Library Suspension","description":"Yeast library labeled with dye-conjugated antibody (e.g., anti-Myc-FITC)","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2018-01-02T14:30:54.000-08:00","updated_at":"2018-01-02T14:30:54.000-08:00","unit":"DNA Library","cost":0.01,"release_method":"return","release_description":"","sample_type_id":70,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"DNA Library"}],"operation_type":{"name":"Challenge and Label","category":"Yeast Display","deployed":false,"on_the_fly":false,"field_types":[{"ftype":"sample","role":"input","name":"Yeast Culture","sample_types":["Yeast Strain","DNA Library"],"object_types":["Yeast 50ml culture","Yeast Library Liquid Culture"],"part":false,"array":false,"routing":"YL","preferred_operation_type_id":362,"preferred_field_type_id":1474,"choices":null},{"ftype":"sample","role":"input","name":"Protease","sample_types":["Protease","Biotinylated Binding Target"],"object_types":["Protease Stock","Biotinylated Binding Target Stock"],"part":false,"array":false,"routing":"P","preferred_operation_type_id":null,"preferred_field_type_id":null,"choices":null},{"ftype":"number","role":"input","name":"Protease Concentration","sample_types":[],"object_types":[],"part":false,"array":false,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"choices":null},{"ftype":"sample","role":"input","name":"Antibody","sample_types":["Antibody"],"object_types":["Antibody Stock"],"part":false,"array":false,"routing":"Ab","preferred_operation_type_id":null,"preferred_field_type_id":null,"choices":null},{"ftype":"sample","role":"output","name":"Labeled Yeast Library","sample_types":["Yeast Strain","DNA Library"],"object_types":["Labeled Yeast Strain Suspension","Labeled Yeast Library Suspension"],"part":false,"array":false,"routing":"YL","preferred_operation_type_id":null,"preferred_field_type_id":null,"choices":null}],"protocol":"# @author Devin Strickland\n# @email dvn.strcklnd@gmail.com\n\nneeds \"Yeast Display/FastMixAndQuench\"\nneeds \"Yeast Display/WashYeast\"\nneeds \"Yeast Display/NormalizeCultureDensity\"\nneeds \"Yeast Display/PrepareTreatmentDilutions\"\nneeds \"Yeast Display/LabelWithAntibody\"\n\nneeds \"Yeast Display/ChallengeAndLabelHelper\"\n\nclass Protocol\n\n    require 'json'\n\n    include FastMixAndQuench, WashYeast, NormalizeCultureDensity, PrepareTreatmentDilutions, LabelWithAntibody\n    include ChallengeAndLabelHelper\n\n    attr_accessor :plan_params\n\n    MY_DEBUG = true\n\n    ########## DEFAULT PARAMS ##########\n\n    # Params that are applied equally to all operations. Can be overridden by\n    #   associating a list of key, value pairs to the `Plan`.\n    #\n    # @example my_plan.associate(\"options\", \"{\"od_ml_needed\": 2.0}\")\n    # @note `:od_ml_needed` should not exceed `3.0`\n    # @note `:quench_milliliters`, `:wash_milliliters` should not exceed `1000`\n    # @note If `:incubate_with_protease` is `false`, then the protease incubation steps\n    #   will be skipped, but `:n_protease_washes` washes will still be performed\n    # @note If `:incubate_with_antibody` is `false`, then the antibody incubation steps\n    #   will be skipped, but `:n_antibody_washes` washes will still be performed\n    def default_plan_params\n        {\n            make_extra_reagent: 1.1,                # Multiplier to make extra master mix for pipetting error\n            od_ml_needed: 2.5,                      # The number of ml of an OD = 1.0 culture, 1.0 = 1.2E7 cells\n            assay_microliters: 500,                 # Total volume after protease is added\n            protease_dilution_factor: 2.0,          # Protease sample is diluted when mixed with the culture\n            protease_working_microliters: 1000,     # How much of each protease sample gets made\n            protease_incubation_time_minutes: 5,    # How long the protease incubation is allowed to proceed\n            vortex_interval_minutes: 2,             # How often the protease incubation is vortexed\n            quench_milliliters: 1.0,                # The volume used to quench the protease reaction\n            wash_milliliters: 1.0,                  # The volume used in each protease or antibody wash\n            n_protease_washes: 4,                   # The number of times to wash after protease treatment\n            antibody_dilution_factor: 100.0,        # The amount that the antibody gets diluted by\n            n_antibody_washes: 2,                   # The number of times to wash after antibody treatment\n            antibody_microliters_per_od_ml: 200,    # The volume of diluted antibody, scales with # of cells\n            incubate_with_protease: true,           # Skips incubation but NOT washes if false\n            quench_protease: true,                  # Skips quench step but NOT washes if true\n            incubate_with_antibody: true,           # Skips incubation AND washes if false\n            pretreatment_item_id: nil,\n            pretreatment_incubation_time_minutes: nil,\n            pretreatment_dilution_factor: nil\n        }\n    end\n\n    ########## MAIN ##########\n\n    def main\n\n        # Setup that runs in the background\n        # These methods should only call show blocks in debug mode\n\n        override_input_operations if debug \u0026\u0026 MY_DEBUG\n\n        @plan_params = default_plan_params\n\n        update_plan_params\n\n        calculate_volumes\n\n        sort_operations\n\n        operations.make\n\n        find_and_add_buffers\n\n        associate_tube_labels\n\n        calculate_and_set_protease_volumes\n\n        # Technician display methods begin here\n\n        prepare_equipment\n\n        gather_buffers_and_proteases\n\n        prepare_pretreatment if @plan_params[:pretreatment_item_id]\n\n        prepare_culture_samples\n\n        incubate_with_pretreatment if @plan_params[:pretreatment_item_id]\n\n        if @plan_params[:incubate_with_protease]\n            prepare_protease_dilutions\n            incubate_with_protease\n        end\n\n        if @plan_params[:n_protease_washes] \u003e 0\n            wash_out_protease\n        end\n\n        if @plan_params[:incubate_with_antibody]\n            label_with_antibody\n        end\n\n        if @plan_params[:n_antibody_washes] \u003e 0\n            wash_out_antibody\n        end\n\n        clean_up\n\n        return {}\n\n    end\n\n    def prepare_pretreatment\n        pretreatment_item = Item.find(@plan_params[:pretreatment_item_id])\n\n        operations.each { |op| add_input_from_item(op, PRETREATMENT, pretreatment_item) }\n\n        final_dilution_factor = @plan_params[:assay_qty][:qty] / @plan_params[:library_qty][:qty]\n        working_dilution_factor = @plan_params[:pretreatment_dilution_factor] / final_dilution_factor\n\n        total_per_rxn = @plan_params[:library_qty][:qty] * @plan_params[:make_extra_reagent]\n\n        stock_per_rxn = {\n            qty: total_per_rxn / working_dilution_factor,\n            units: @plan_params[:assay_qty][:units]\n        }\n\n        buffer_per_rxn = {\n            qty: total_per_rxn - stock_per_rxn[:qty],\n            units: @plan_params[:assay_qty][:units]\n        }\n\n        prepare_reagent(\n            stock_per_rxn: stock_per_rxn,\n            buffer_per_rxn: buffer_per_rxn,\n            reagent_name: pretreatment_item.sample.name,\n            reagent_handle: PRETREATMENT,\n            buffer_handle: INCUBATION_BUFFER,\n            temp: ROOM_TEMP,\n            debug: debug \u0026\u0026 MY_DEBUG\n        )\n    end\n\n    def incubate_with_pretreatment\n        incubation_time = @plan_params[:pretreatment_incubation_time_minutes]\n        incubation_time = \"#{incubation_time} #{MINUTES}\"\n        show do\n            title \"Incubate Resuspended Cultures\"\n\n            note \"Incubate the resuspended library cultures for #{incubation_time}.\"\n        end\n    end\n\n    ########## DISPLAY METHODS WITH DEDICATED MODULES ##########\n\n    # Retrieve the cultures, measure the ODs, centrifuge and resuspend in the appropriate volume.\n    #\n    def prepare_culture_samples\n\n        operations.retrieve(only: INPUT_YEAST)\n\n        unique_culture_operations = normalize_culture_density(\n            input_handle: INPUT_YEAST,\n            output_handle: OUTPUT_YEAST,\n            buffer_handle: INCUBATION_BUFFER,\n            temp: ROOM_TEMP,\n            resuspend_qty: @plan_params[:library_qty],\n            od_ml_needed: @plan_params[:od_ml_needed],\n            debug: debug \u0026\u0026 MY_DEBUG\n        )\n\n        uc_items = unique_culture_operations.map { |op| op.input(INPUT_YEAST).item }\n\n        mark_cultures_for_discard(uc_items)\n\n        release(uc_items, interactive: true)\n\n    end\n\n    def prepare_protease_dilutions\n        prepare_treatment_dilutions(\n            treatment_handle: PROTEASE,\n            buffer_handle: INCUBATION_BUFFER,\n            output_handle: OUTPUT_YEAST,\n            treatment_working_qty: @plan_params[:protease_working_qty],\n            temp: ROOM_TEMP\n        )\n    end\n\n    def incubate_with_protease\n        grouped_ops = ops_by_inc_bfr\n\n        arrange_tubes(\n            grouped_ops: grouped_ops,\n            output_handle: OUTPUT_YEAST,\n            temp: ROOM_TEMP\n        )\n\n        mix_samples(\n            grouped_ops: grouped_ops,\n            treatment_vol: @plan_params[:protease_qty]\n        )\n\n        incubate(\n            grouped_ops: grouped_ops,\n            output_handle: OUTPUT_YEAST,\n            incubation_time: @plan_params[:protease_incubation_time_qty],\n            vortex_interval: @plan_params[:vortex_interval_qty],\n            quench_vol: @plan_params[:quench_qty],\n            buffer_handle: QUENCH_BUFFER,\n            quench_protease: @plan_params[:quench_protease]\n        )\n    end\n\n    def wash_out_protease\n        buffer_handle = @plan_params[:quench_protease] ? QUENCH_BUFFER : INCUBATION_BUFFER\n        wash_yeast(\n            grouped_ops: ops_by_inc_bfr,\n            n_washes: @plan_params[:n_protease_washes],\n            wash_vol: @plan_params[:wash_qty],\n            output_handle: OUTPUT_YEAST,\n            buffer_handle: buffer_handle,\n            temp: ON_ICE\n        )\n    end\n\n    def label_with_antibody\n        prepare_reagent(\n            stock_per_rxn: @plan_params[:antibody_stock_per_rxn],\n            buffer_per_rxn: @plan_params[:antibody_buffer_per_rxn],\n            reagent_name: 'antibody',\n            reagent_handle: ANTIBODY,\n            buffer_handle: BINDING_BUFFER,\n            debug: debug \u0026\u0026 MY_DEBUG\n        )\n\n        incubate_with_antibody(\n            antibody_qty: @plan_params[:antibody_qty]\n        )\n    end\n\n    def wash_out_antibody\n        wash_yeast(\n            grouped_ops: ops_by_binding_bfr,\n            n_washes: @plan_params[:n_antibody_washes],\n            wash_vol: @plan_params[:wash_qty],\n            output_handle: OUTPUT_YEAST,\n            buffer_handle: BINDING_BUFFER,\n            temp: ON_ICE\n        )\n    end\n\n    ########## DATA PROCESSING METHODS ##########\n\n    # Gets :options from the plan associations and uses it to override @plan_params defaults.\n    #\n    # @note Modifies @plan_params, an instance variable of the Protocol.\n    def update_plan_params\n        opts = operations.first.plan.associations[:options]\n\n        if opts.present?\n            opts = JSON.parse(opts, { symbolize_names: true })\n            plan_params.update(opts)\n        end\n\n        if debug \u0026\u0026 MY_DEBUG\n            associate_plan_options(plan_params)\n        end\n    end\n\n    # Calculates volume @plan_params and formats them for display purposes.\n    #\n    # @note Modifies @plan_params, an instance variable of the Protocol.\n    def calculate_volumes\n        # TODO: Think about whether this is the right priority for these params being defined\n        # Devin removed this calculation because it results in too much culture volume. No longer\n        # automatically scaling reaction volume with OD*ml\n        # assay_microliters = @plan_params[:assay_microliters_per_od_ml] * @plan_params[:od_ml_needed]\n        # @plan_params[:assay_microliters] = assay_microliters\n\n        @plan_params[:protease_microliters] = @plan_params[:assay_microliters] / @plan_params[:protease_dilution_factor]\n        @plan_params[:library_microliters] = @plan_params[:assay_microliters] - @plan_params[:protease_microliters]\n        @plan_params[:antibody_microliters] = @plan_params[:antibody_microliters_per_od_ml] * @plan_params[:od_ml_needed]\n\n        # Takes _microliters and _milliliters keys and generates _vol keys for display purposes.\n        @plan_params = add_qty_display(@plan_params)\n\n        @plan_params[:antibody_stock_per_rxn] = {\n            qty: @plan_params[:antibody_qty][:qty] / @plan_params[:antibody_dilution_factor],\n            units: @plan_params[:antibody_qty][:units]\n        }\n\n        @plan_params[:antibody_buffer_per_rxn] = {\n            qty: @plan_params[:antibody_qty][:qty] - @plan_params[:antibody_stock_per_rxn][:qty],\n            units: @plan_params[:antibody_qty][:units]\n        }\n\n        @plan_params[:antibody_stock_per_rxn][:qty] *= @plan_params[:make_extra_reagent]\n        @plan_params[:antibody_buffer_per_rxn][:qty] *= @plan_params[:make_extra_reagent]\n\n        @plan_params\n    end\n\n    # Loops over the operations and calls a method to find and add buffers.\n    #\n    def find_and_add_buffers\n        operations.each do |op|\n            protease = op.input(PROTEASE).sample\n            add_buffers(op, protease, INCUBATION_BUFFER)\n            add_buffers(op, protease, QUENCH_BUFFER)\n\n            antibody = op.input(ANTIBODY).sample\n            add_buffers(op, antibody, BINDING_BUFFER)\n        end\n    end\n\n    # Figures out which buffers are needed and adds them to the passed operation.\n    #\n    def add_buffers(op, reagent, handle)\n        sample_id = reagent.properties[\"#{handle} id\"]\n\n        if sample_id\n            buffer = Sample.find(sample_id)\n        else\n            buffer = reagent.properties[\"#{handle}\"]\n        end\n\n        return unless buffer\n        container = buffer_container(buffer: buffer, handle: handle)\n        item = op.add_input(handle, buffer, container)\n    end\n\n    # Calculates and sets operation-specific protease volumes based on the activities of the stocks.\n    #\n    def calculate_and_set_protease_volumes\n        protease_samples.each do |protease|\n            protease_ops = operations.select { |op| op.input(PROTEASE).sample == protease }\n            stock_conc = stock_concentration(ops: protease_ops)\n            protease_ops.each { |op| set_protease_volumes(op, stock_conc) }\n        end\n    end\n\n    def stock_concentration(ops: protease_ops)\n        concs = ops.map { |op| op.input(PROTEASE).item.get(:units_per_milliliter) }.uniq\n        raise 'Protease activity error.' unless concs.length == 1\n        concs.first.to_i\n    end\n\n    def protease_ops(protease)\n        operations.select { |op| op.input(PROTEASE).sample == protease }\n    end\n\n    # Sets protease and buffer volumes for the passed operation.\n    #\n    # @param op [Operation] the operation that the columes are set for\n    # @param stock_conc [Numeric] the activity of the protease stock\n    def set_protease_volumes(op, stock_conc)\n        this_conc = protease_conc(op) * @plan_params[:protease_dilution_factor]\n        prot_vol = @plan_params[:protease_working_qty][:qty] * this_conc / stock_conc\n        buf_vol = @plan_params[:protease_working_qty][:qty] - prot_vol\n        op.temporary[:treatment_qty] = prot_vol\n        op.temporary[:buffer_qty] = buf_vol\n    end\n\n    # Assigns an incremental tube number for each yeast culture and protease.\n    # Overrides the `associate_tube_labels` in the `TemporaryTubeLabels` module.\n    def associate_tube_labels\n        operations.each_with_index do |op, i|\n            op.output(OUTPUT_YEAST).item.associate(:sample_tube_label, \"S#{i + 1}\")\n            op.output(OUTPUT_YEAST).item.associate(:treatment_tube_label, \"T#{i + 1}\")\n        end\n\n        # check_labels if debug\n    end\n\nend","precondition":"def precondition(_op)\n  true\nend","cost_model":"def cost(op)\n  { labor: 16.121, materials: 11.74 }\nend","documentation":"Documentation here. Start with a paragraph, not a heading or title, as in most views, the title will be supplied by the view.","test":"","timing":null}},{"sample_types":[{"id":5,"name":"Yeast Strain","description":"A strain of yeast distinguished from others by genomic or plasmid modifications","created_at":"2013-10-16T14:37:29.000-07:00","updated_at":"2015-12-08T17:40:57.000-08:00","field_types":[{"id":18,"parent_id":5,"name":"Parent","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-25T08:43:19.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":8,"field_type_id":18,"sample_type_id":5,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":5,"name":"Yeast Strain","description":"A strain of yeast distinguished from others by genomic or plasmid modifications","created_at":"2013-10-16T14:37:29.000-07:00","updated_at":"2015-12-08T17:40:57.000-08:00"}}],"sample_types":["Yeast Strain"],"object_types":[null]},{"id":19,"parent_id":5,"name":"Integrant","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":9,"field_type_id":19,"sample_type_id":2,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":2,"name":"Plasmid","description":"A circular piece of double stranded DNA","created_at":"2013-10-15T09:59:25.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":10,"field_type_id":19,"sample_type_id":4,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Plasmid","Fragment"],"object_types":[null,null]},{"id":20,"parent_id":5,"name":"Plasmid","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":11,"field_type_id":20,"sample_type_id":2,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":2,"name":"Plasmid","description":"A circular piece of double stranded DNA","created_at":"2013-10-15T09:59:25.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Plasmid"],"object_types":[null]},{"id":21,"parent_id":5,"name":"Integrated Marker(s)","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":22,"parent_id":5,"name":"Plasmid Marker(s)","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":23,"parent_id":5,"name":"Mating Type","ftype":"string","choices":"MATa,MATalpha,Diploid","array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-10T09:05:01.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":24,"parent_id":5,"name":"QC Primer1","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":12,"field_type_id":24,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":25,"parent_id":5,"name":"QC Primer2","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":13,"field_type_id":25,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":43,"parent_id":5,"name":"QC_length","ftype":"number","choices":"","array":false,"required":false,"created_at":"2016-05-20T14:29:39.000-07:00","updated_at":"2016-05-20T14:35:37.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":44,"parent_id":5,"name":"Comp_cell_limit","ftype":"string","choices":"Yes,No","array":false,"required":false,"created_at":"2016-05-20T14:35:37.000-07:00","updated_at":"2016-05-20T14:35:37.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":83,"parent_id":5,"name":"Media","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2017-07-12T19:25:25.000-07:00","updated_at":"2017-07-12T19:25:25.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":954,"parent_id":5,"name":"Has this strain passed QC?","ftype":"string","choices":"No,Yes","array":false,"required":false,"created_at":"2017-10-31T11:39:27.000-07:00","updated_at":"2017-10-31T20:14:46.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":6455,"parent_id":5,"name":"Haploids","ftype":"sample","choices":null,"array":true,"required":false,"created_at":"2018-10-24T19:01:40.000-07:00","updated_at":"2018-10-24T19:01:40.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":2669,"field_type_id":6455,"sample_type_id":5,"object_type_id":null,"created_at":"2018-10-24T19:01:40.000-07:00","updated_at":"2018-10-24T19:01:40.000-07:00","sample_type":{"id":5,"name":"Yeast Strain","description":"A strain of yeast distinguished from others by genomic or plasmid modifications","created_at":"2013-10-16T14:37:29.000-07:00","updated_at":"2015-12-08T17:40:57.000-08:00"}}],"sample_types":["Yeast Strain"],"object_types":[null]}]},{"id":2,"name":"Plasmid","description":"A circular piece of double stranded DNA","created_at":"2013-10-15T09:59:25.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00","field_types":[{"id":4,"parent_id":2,"name":"Sequence","ftype":"url","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:30:08.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":5,"parent_id":2,"name":"Sequence Verification","ftype":"url","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:16:33.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":6,"parent_id":2,"name":"Bacterial Marker","ftype":"string","choices":"Amp,Kan,Amp + Kan,Spec,Kan + Spec,Chlor,Tet,NA,Other","array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2017-12-27T11:26:31.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":7,"parent_id":2,"name":"Yeast Marker","ftype":"string","choices":"HIS,TRP,URA,LEU,NatMX,KanMX,HygMX,BleoMX,5FOA,NA,Other","array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2017-02-13T10:49:58.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":27,"field_type_id":7,"sample_type_id":1,"object_type_id":null,"created_at":"2017-02-13T10:49:58.000-08:00","updated_at":"2017-02-13T10:49:58.000-08:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":8,"parent_id":2,"name":"Length","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:16:33.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":42,"parent_id":2,"name":"Sequencing Primers","ftype":"sample","choices":null,"array":true,"required":false,"created_at":"2016-05-09T21:30:48.000-07:00","updated_at":"2016-05-09T21:30:48.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":26,"field_type_id":42,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T21:30:48.000-07:00","updated_at":"2016-05-09T21:30:48.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":46,"parent_id":2,"name":"QC Primer1","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":29,"field_type_id":46,"sample_type_id":1,"object_type_id":null,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":47,"parent_id":2,"name":"QC Primer2","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":30,"field_type_id":47,"sample_type_id":1,"object_type_id":null,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":48,"parent_id":2,"name":"QC_length","ftype":"number","choices":null,"array":false,"required":false,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":5816,"parent_id":2,"name":"Transformation Temperature","ftype":"number","choices":"37,30","array":false,"required":false,"created_at":"2018-09-17T15:02:22.000-07:00","updated_at":"2018-11-06T11:31:23.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":16203,"parent_id":2,"name":"Comp Cells","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2020-02-14T10:28:40.000-08:00","updated_at":"2020-02-14T10:28:40.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":3108,"field_type_id":16203,"sample_type_id":3,"object_type_id":null,"created_at":"2020-02-14T10:28:40.000-08:00","updated_at":"2020-02-14T10:28:40.000-08:00","sample_type":{"id":3,"name":"E coli strain","description":"A strain of E coli distinguished from others by genomic (not plasmid) modifications.","created_at":"2013-10-15T10:16:52.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["E coli strain"],"object_types":[null]}]},{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00","field_types":[{"id":1,"parent_id":1,"name":"Overhang Sequence","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":2,"parent_id":1,"name":"Anneal Sequence","ftype":"string","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3,"parent_id":1,"name":"T Anneal","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]}]},{"id":3,"name":"E coli strain","description":"A strain of E coli distinguished from others by genomic (not plasmid) modifications.","created_at":"2013-10-15T10:16:52.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00","field_types":[{"id":10,"parent_id":3,"name":"Parent","ftype":"sample","choices":null,"array":null,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1,"field_type_id":10,"sample_type_id":3,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":3,"name":"E coli strain","description":"A strain of E coli distinguished from others by genomic (not plasmid) modifications.","created_at":"2013-10-15T10:16:52.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["E coli strain"],"object_types":[null]}]},{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00","field_types":[{"id":11,"parent_id":4,"name":"Sequence","ftype":"url","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:17:39.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":12,"parent_id":4,"name":"Length","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:17:39.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":13,"parent_id":4,"name":"Template","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-12T19:07:59.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":2,"field_type_id":13,"sample_type_id":2,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":2,"name":"Plasmid","description":"A circular piece of double stranded DNA","created_at":"2013-10-15T09:59:25.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":3,"field_type_id":13,"sample_type_id":3,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":3,"name":"E coli strain","description":"A strain of E coli distinguished from others by genomic (not plasmid) modifications.","created_at":"2013-10-15T10:16:52.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":4,"field_type_id":13,"sample_type_id":4,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":5,"field_type_id":13,"sample_type_id":5,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":5,"name":"Yeast Strain","description":"A strain of yeast distinguished from others by genomic or plasmid modifications","created_at":"2013-10-16T14:37:29.000-07:00","updated_at":"2015-12-08T17:40:57.000-08:00"}},{"id":2547,"field_type_id":13,"sample_type_id":70,"object_type_id":null,"created_at":"2018-09-18T16:02:54.000-07:00","updated_at":"2018-09-18T16:02:54.000-07:00","sample_type":{"id":70,"name":"DNA Library","description":"A sample that contains a pool of DNA molecules with many unique sequences","created_at":"2018-01-02T14:28:12.000-08:00","updated_at":"2018-01-02T14:28:12.000-08:00"}}],"sample_types":["Plasmid","E coli strain","Fragment","Yeast Strain","DNA Library"],"object_types":[null,null,null,null,null]},{"id":14,"parent_id":4,"name":"Forward Primer","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-12T19:07:59.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":6,"field_type_id":14,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":2664,"field_type_id":14,"sample_type_id":4,"object_type_id":null,"created_at":"2018-10-22T13:03:32.000-07:00","updated_at":"2018-10-22T13:03:32.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer","Fragment"],"object_types":[null,null]},{"id":15,"parent_id":4,"name":"Reverse Primer","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-12T19:07:59.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":7,"field_type_id":15,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":2665,"field_type_id":15,"sample_type_id":4,"object_type_id":null,"created_at":"2018-10-22T13:03:32.000-07:00","updated_at":"2018-10-22T13:03:32.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer","Fragment"],"object_types":[null,null]},{"id":16,"parent_id":4,"name":"Restriction Enzyme(s)","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:17:39.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":17,"parent_id":4,"name":"Yeast Marker","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:17:39.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":6423,"parent_id":4,"name":"Fragment Mix Array","ftype":"sample","choices":null,"array":true,"required":false,"created_at":"2018-10-23T13:35:15.000-07:00","updated_at":"2018-10-24T11:05:59.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":2667,"field_type_id":6423,"sample_type_id":1,"object_type_id":null,"created_at":"2018-10-23T13:35:15.000-07:00","updated_at":"2018-10-23T13:35:15.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":2668,"field_type_id":6423,"sample_type_id":4,"object_type_id":null,"created_at":"2018-10-23T13:35:15.000-07:00","updated_at":"2018-10-23T13:35:15.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer","Fragment"],"object_types":[null,null]}]},{"id":70,"name":"DNA Library","description":"A sample that contains a pool of DNA molecules with many unique sequences","created_at":"2018-01-02T14:28:12.000-08:00","updated_at":"2018-01-02T14:28:12.000-08:00","field_types":[{"id":3965,"parent_id":70,"name":"Oligo Pool","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2018-06-05T14:45:01.000-07:00","updated_at":"2018-06-05T14:45:01.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1772,"field_type_id":3965,"sample_type_id":75,"object_type_id":null,"created_at":"2018-06-05T14:45:01.000-07:00","updated_at":"2018-06-05T14:45:01.000-07:00","sample_type":{"id":75,"name":"Oligo Pool","description":"Pool or library of ssDNA oligos. May contain one or more sublibraries. In array fields, the n-th position corresponds to n-th sublibrary. \"forward priming site\" and \"reverse priming site\" are read as primer sequences.","created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2019-01-23T16:24:45.000-08:00"}}],"sample_types":["Oligo Pool"],"object_types":[null]}]},{"id":75,"name":"Oligo Pool","description":"Pool or library of ssDNA oligos. May contain one or more sublibraries. In array fields, the n-th position corresponds to n-th sublibrary. \"forward priming site\" and \"reverse priming site\" are read as primer sequences.","created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2019-01-23T16:24:45.000-08:00","field_types":[{"id":3947,"parent_id":75,"name":"Manufacturer","ftype":"string","choices":null,"array":false,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-07T09:48:57.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3948,"parent_id":75,"name":"Oligo Library ID","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-07T09:48:57.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3949,"parent_id":75,"name":"inner forward primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1763,"field_type_id":3949,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3950,"parent_id":75,"name":"inner reverse primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1764,"field_type_id":3950,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3951,"parent_id":75,"name":"sublibrary forward primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1765,"field_type_id":3951,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3952,"parent_id":75,"name":"sublibrary reverse primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1766,"field_type_id":3952,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3953,"parent_id":75,"name":"min length (nt) (array)","ftype":"number","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3954,"parent_id":75,"name":"max length (nt) (array)","ftype":"number","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3955,"parent_id":75,"name":"variants (array)","ftype":"number","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3964,"parent_id":75,"name":"sublibrary name (array)","ftype":"string","choices":null,"array":true,"required":true,"created_at":"2018-06-05T14:37:16.000-07:00","updated_at":"2018-06-05T14:37:16.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":7477,"parent_id":75,"name":"forward priming site (array)","ftype":"string","choices":null,"array":true,"required":true,"created_at":"2019-01-23T16:24:45.000-08:00","updated_at":"2019-01-23T16:24:45.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":7478,"parent_id":75,"name":"reverse priming site (array)","ftype":"string","choices":null,"array":true,"required":true,"created_at":"2019-01-23T16:24:45.000-08:00","updated_at":"2019-01-23T16:24:45.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]}]},{"id":15,"name":"Media","description":"Media for yeast and E. coli","created_at":"2015-12-16T14:13:57.000-08:00","updated_at":"2015-12-16T14:35:10.000-08:00","field_types":[]}],"object_types":[{"id":740,"name":"Yeast 5ml culture","description":"A 5 ml yeast culture in a 15 ml glass culture tube","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2017-12-18T12:01:59.000-08:00","updated_at":"2017-12-18T12:01:59.000-08:00","unit":"Yeast Strain","cost":0.01,"release_method":"return","release_description":"","sample_type_id":5,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"Yeast Strain"},{"id":748,"name":"Yeast Library Liquid Culture","description":"A special case of yeast culture that contains a strain library","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2018-01-02T14:33:08.000-08:00","updated_at":"2018-01-02T14:33:08.000-08:00","unit":"DNA Library","cost":0.01,"release_method":"return","release_description":"","sample_type_id":70,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"DNA Library"},{"id":428,"name":"Yeast 50ml culture","description":"Culture for making comp cells","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2014-07-30T15:07:45.000-07:00","updated_at":"2014-08-12T19:17:15.000-07:00","unit":"Yeast Strain","cost":0.01,"release_method":"dispose","release_description":"","sample_type_id":5,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"Yeast Strain"},{"id":466,"name":"800 mL Liquid","description":"800 mL Bottle","min":0,"max":10000,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":" {\r\n    \"samples\": [\r\n      { \"name\": \"SC\",   \"materials\": 0.0135, \"labor\": 0.028, \"delete\": false, \"unit\": \"mL\", \"total_volume\": 800 },\r\n      { \"name\": \"SDO\",  \"materials\": 0.014, \"labor\": 0.028, \"delete\": false, \"unit\": \"mL\", \"total_volume\": 800 },\r\n      { \"name\": \"50% Glycerol\",   \"materials\": 0.02, \"labor\": 0.02, \"delete\": false, \"unit\": \"mL\", \"total_volume\": 800 },\r\n      { \"name\": \"TB\",   \"materials\": 0.01, \"labor\": 0.016, \"delete\": false, \"unit\": \"mL\", \"total_volume\": 800 },\r\n      { \"name\": \"TB + Amp\",   \"materials\": 0.03, \"labor\": 0.028, \"delete\": false, \"unit\": \"mL\", \"total_volume\": 800 },\r\n      { \"name\": \"LB\",   \"materials\": 0.01, \"labor\": 0.016, \"delete\": false, \"unit\": \"mL\", \"total_volume\": 800 },     \r\n      { \"name\": \"YPAD\", \"materials\": 0.01, \"labor\": 0.025, \"delete\": false, \"unit\": \"mL\", \"total_volume\": 800 }\r\n    ]\r\n  }","vendor":"No vendor information","created_at":"2015-12-16T14:35:46.000-08:00","updated_at":"2017-06-13T11:30:03.000-07:00","unit":"Media","cost":0.01,"release_method":"return","release_description":"","sample_type_id":15,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"Media"}],"operation_type":{"name":"Dilute Yeast Library","category":"Yeast Display","deployed":false,"on_the_fly":false,"field_types":[{"ftype":"sample","role":"input","name":"Yeast Culture","sample_types":["Yeast Strain","DNA Library","Yeast Strain"],"object_types":["Yeast 5ml culture","Yeast Library Liquid Culture","Yeast 50ml culture"],"part":false,"array":false,"routing":"YL","preferred_operation_type_id":361,"preferred_field_type_id":1471,"choices":null},{"ftype":"sample","role":"input","name":"Media","sample_types":["Media"],"object_types":["800 mL Liquid"],"part":false,"array":false,"routing":"M","preferred_operation_type_id":178,"preferred_field_type_id":699,"choices":null},{"ftype":"sample","role":"output","name":"Yeast Culture","sample_types":["Yeast Strain","DNA Library"],"object_types":["Yeast 50ml culture","Yeast Library Liquid Culture"],"part":false,"array":false,"routing":"YL","preferred_operation_type_id":null,"preferred_field_type_id":null,"choices":null}],"protocol":"# Devin Strickland\n# dvn.strcklnd@gmail.com\n\nneeds \"Yeast Display/YeastDisplayShows\"\nneeds \"Yeast Display/YeastDisplayHelper\"\nneeds \"Standard Libs/Debug\"\nneeds \"Standard Libs/SortHelper\"\n\nclass Protocol\n\n    include YeastDisplayShows, YeastDisplayHelper, Debug, SortHelper\n\n    def main\n        \n        # DO NOT DELETE \n        ops_sorted=sortByMultipleIO(operations, [\"in\"], [INPUT_YEAST], [\"id\"], [\"item\"])\n        operations=ops_sorted\n        \n        operations.retrieve\n        \n        group_ops_by_container.each do |container, container_group|\n            container_group.make\n            prepare_media_and_dilute(container, container_group)\n        end\n        \n        return_to_incubator\n        \n        mark_cultures_for_discard(operations.map { |op| op.input(INPUT_YEAST).item })\n        \n        operations.store\n        \n        # DO NOT DELETE \n        operations.each { |op|\n            if( !(op.input(INPUT_YEAST).item.get(:bin).nil?) ) # sorted sample\n                op.output(OUTPUT_YEAST).item.associate(:bin, op.input(INPUT_YEAST).item.get(:bin))\n            end\n        }\n        operations.store\n        \n    end\n\nend\n","precondition":"def precondition(_op)\n  true\nend","cost_model":"def cost(_op)\n  { labor: 4.012, materials: 2.86 }\nend","documentation":"Documentation here. Start with a paragraph, not a heading or title, as in most views, the title will be supplied by the view.","test":"","timing":null}},{"sample_types":[{"id":5,"name":"Yeast Strain","description":"A strain of yeast distinguished from others by genomic or plasmid modifications","created_at":"2013-10-16T14:37:29.000-07:00","updated_at":"2015-12-08T17:40:57.000-08:00","field_types":[{"id":18,"parent_id":5,"name":"Parent","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-25T08:43:19.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":8,"field_type_id":18,"sample_type_id":5,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":5,"name":"Yeast Strain","description":"A strain of yeast distinguished from others by genomic or plasmid modifications","created_at":"2013-10-16T14:37:29.000-07:00","updated_at":"2015-12-08T17:40:57.000-08:00"}}],"sample_types":["Yeast Strain"],"object_types":[null]},{"id":19,"parent_id":5,"name":"Integrant","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":9,"field_type_id":19,"sample_type_id":2,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":2,"name":"Plasmid","description":"A circular piece of double stranded DNA","created_at":"2013-10-15T09:59:25.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":10,"field_type_id":19,"sample_type_id":4,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Plasmid","Fragment"],"object_types":[null,null]},{"id":20,"parent_id":5,"name":"Plasmid","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":11,"field_type_id":20,"sample_type_id":2,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":2,"name":"Plasmid","description":"A circular piece of double stranded DNA","created_at":"2013-10-15T09:59:25.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Plasmid"],"object_types":[null]},{"id":21,"parent_id":5,"name":"Integrated Marker(s)","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":22,"parent_id":5,"name":"Plasmid Marker(s)","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":23,"parent_id":5,"name":"Mating Type","ftype":"string","choices":"MATa,MATalpha,Diploid","array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-10T09:05:01.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":24,"parent_id":5,"name":"QC Primer1","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":12,"field_type_id":24,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":25,"parent_id":5,"name":"QC Primer2","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":13,"field_type_id":25,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":43,"parent_id":5,"name":"QC_length","ftype":"number","choices":"","array":false,"required":false,"created_at":"2016-05-20T14:29:39.000-07:00","updated_at":"2016-05-20T14:35:37.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":44,"parent_id":5,"name":"Comp_cell_limit","ftype":"string","choices":"Yes,No","array":false,"required":false,"created_at":"2016-05-20T14:35:37.000-07:00","updated_at":"2016-05-20T14:35:37.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":83,"parent_id":5,"name":"Media","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2017-07-12T19:25:25.000-07:00","updated_at":"2017-07-12T19:25:25.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":954,"parent_id":5,"name":"Has this strain passed QC?","ftype":"string","choices":"No,Yes","array":false,"required":false,"created_at":"2017-10-31T11:39:27.000-07:00","updated_at":"2017-10-31T20:14:46.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":6455,"parent_id":5,"name":"Haploids","ftype":"sample","choices":null,"array":true,"required":false,"created_at":"2018-10-24T19:01:40.000-07:00","updated_at":"2018-10-24T19:01:40.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":2669,"field_type_id":6455,"sample_type_id":5,"object_type_id":null,"created_at":"2018-10-24T19:01:40.000-07:00","updated_at":"2018-10-24T19:01:40.000-07:00","sample_type":{"id":5,"name":"Yeast Strain","description":"A strain of yeast distinguished from others by genomic or plasmid modifications","created_at":"2013-10-16T14:37:29.000-07:00","updated_at":"2015-12-08T17:40:57.000-08:00"}}],"sample_types":["Yeast Strain"],"object_types":[null]}]},{"id":2,"name":"Plasmid","description":"A circular piece of double stranded DNA","created_at":"2013-10-15T09:59:25.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00","field_types":[{"id":4,"parent_id":2,"name":"Sequence","ftype":"url","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:30:08.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":5,"parent_id":2,"name":"Sequence Verification","ftype":"url","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:16:33.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":6,"parent_id":2,"name":"Bacterial Marker","ftype":"string","choices":"Amp,Kan,Amp + Kan,Spec,Kan + Spec,Chlor,Tet,NA,Other","array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2017-12-27T11:26:31.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":7,"parent_id":2,"name":"Yeast Marker","ftype":"string","choices":"HIS,TRP,URA,LEU,NatMX,KanMX,HygMX,BleoMX,5FOA,NA,Other","array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2017-02-13T10:49:58.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":27,"field_type_id":7,"sample_type_id":1,"object_type_id":null,"created_at":"2017-02-13T10:49:58.000-08:00","updated_at":"2017-02-13T10:49:58.000-08:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":8,"parent_id":2,"name":"Length","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:16:33.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":42,"parent_id":2,"name":"Sequencing Primers","ftype":"sample","choices":null,"array":true,"required":false,"created_at":"2016-05-09T21:30:48.000-07:00","updated_at":"2016-05-09T21:30:48.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":26,"field_type_id":42,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T21:30:48.000-07:00","updated_at":"2016-05-09T21:30:48.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":46,"parent_id":2,"name":"QC Primer1","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":29,"field_type_id":46,"sample_type_id":1,"object_type_id":null,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":47,"parent_id":2,"name":"QC Primer2","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":30,"field_type_id":47,"sample_type_id":1,"object_type_id":null,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":48,"parent_id":2,"name":"QC_length","ftype":"number","choices":null,"array":false,"required":false,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":5816,"parent_id":2,"name":"Transformation Temperature","ftype":"number","choices":"37,30","array":false,"required":false,"created_at":"2018-09-17T15:02:22.000-07:00","updated_at":"2018-11-06T11:31:23.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":16203,"parent_id":2,"name":"Comp Cells","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2020-02-14T10:28:40.000-08:00","updated_at":"2020-02-14T10:28:40.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":3108,"field_type_id":16203,"sample_type_id":3,"object_type_id":null,"created_at":"2020-02-14T10:28:40.000-08:00","updated_at":"2020-02-14T10:28:40.000-08:00","sample_type":{"id":3,"name":"E coli strain","description":"A strain of E coli distinguished from others by genomic (not plasmid) modifications.","created_at":"2013-10-15T10:16:52.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["E coli strain"],"object_types":[null]}]},{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00","field_types":[{"id":1,"parent_id":1,"name":"Overhang Sequence","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":2,"parent_id":1,"name":"Anneal Sequence","ftype":"string","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3,"parent_id":1,"name":"T Anneal","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]}]},{"id":3,"name":"E coli strain","description":"A strain of E coli distinguished from others by genomic (not plasmid) modifications.","created_at":"2013-10-15T10:16:52.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00","field_types":[{"id":10,"parent_id":3,"name":"Parent","ftype":"sample","choices":null,"array":null,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1,"field_type_id":10,"sample_type_id":3,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":3,"name":"E coli strain","description":"A strain of E coli distinguished from others by genomic (not plasmid) modifications.","created_at":"2013-10-15T10:16:52.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["E coli strain"],"object_types":[null]}]},{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00","field_types":[{"id":11,"parent_id":4,"name":"Sequence","ftype":"url","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:17:39.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":12,"parent_id":4,"name":"Length","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:17:39.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":13,"parent_id":4,"name":"Template","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-12T19:07:59.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":2,"field_type_id":13,"sample_type_id":2,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":2,"name":"Plasmid","description":"A circular piece of double stranded DNA","created_at":"2013-10-15T09:59:25.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":3,"field_type_id":13,"sample_type_id":3,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":3,"name":"E coli strain","description":"A strain of E coli distinguished from others by genomic (not plasmid) modifications.","created_at":"2013-10-15T10:16:52.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":4,"field_type_id":13,"sample_type_id":4,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":5,"field_type_id":13,"sample_type_id":5,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":5,"name":"Yeast Strain","description":"A strain of yeast distinguished from others by genomic or plasmid modifications","created_at":"2013-10-16T14:37:29.000-07:00","updated_at":"2015-12-08T17:40:57.000-08:00"}},{"id":2547,"field_type_id":13,"sample_type_id":70,"object_type_id":null,"created_at":"2018-09-18T16:02:54.000-07:00","updated_at":"2018-09-18T16:02:54.000-07:00","sample_type":{"id":70,"name":"DNA Library","description":"A sample that contains a pool of DNA molecules with many unique sequences","created_at":"2018-01-02T14:28:12.000-08:00","updated_at":"2018-01-02T14:28:12.000-08:00"}}],"sample_types":["Plasmid","E coli strain","Fragment","Yeast Strain","DNA Library"],"object_types":[null,null,null,null,null]},{"id":14,"parent_id":4,"name":"Forward Primer","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-12T19:07:59.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":6,"field_type_id":14,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":2664,"field_type_id":14,"sample_type_id":4,"object_type_id":null,"created_at":"2018-10-22T13:03:32.000-07:00","updated_at":"2018-10-22T13:03:32.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer","Fragment"],"object_types":[null,null]},{"id":15,"parent_id":4,"name":"Reverse Primer","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-12T19:07:59.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":7,"field_type_id":15,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":2665,"field_type_id":15,"sample_type_id":4,"object_type_id":null,"created_at":"2018-10-22T13:03:32.000-07:00","updated_at":"2018-10-22T13:03:32.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer","Fragment"],"object_types":[null,null]},{"id":16,"parent_id":4,"name":"Restriction Enzyme(s)","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:17:39.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":17,"parent_id":4,"name":"Yeast Marker","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:17:39.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":6423,"parent_id":4,"name":"Fragment Mix Array","ftype":"sample","choices":null,"array":true,"required":false,"created_at":"2018-10-23T13:35:15.000-07:00","updated_at":"2018-10-24T11:05:59.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":2667,"field_type_id":6423,"sample_type_id":1,"object_type_id":null,"created_at":"2018-10-23T13:35:15.000-07:00","updated_at":"2018-10-23T13:35:15.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":2668,"field_type_id":6423,"sample_type_id":4,"object_type_id":null,"created_at":"2018-10-23T13:35:15.000-07:00","updated_at":"2018-10-23T13:35:15.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer","Fragment"],"object_types":[null,null]}]},{"id":70,"name":"DNA Library","description":"A sample that contains a pool of DNA molecules with many unique sequences","created_at":"2018-01-02T14:28:12.000-08:00","updated_at":"2018-01-02T14:28:12.000-08:00","field_types":[{"id":3965,"parent_id":70,"name":"Oligo Pool","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2018-06-05T14:45:01.000-07:00","updated_at":"2018-06-05T14:45:01.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1772,"field_type_id":3965,"sample_type_id":75,"object_type_id":null,"created_at":"2018-06-05T14:45:01.000-07:00","updated_at":"2018-06-05T14:45:01.000-07:00","sample_type":{"id":75,"name":"Oligo Pool","description":"Pool or library of ssDNA oligos. May contain one or more sublibraries. In array fields, the n-th position corresponds to n-th sublibrary. \"forward priming site\" and \"reverse priming site\" are read as primer sequences.","created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2019-01-23T16:24:45.000-08:00"}}],"sample_types":["Oligo Pool"],"object_types":[null]}]},{"id":75,"name":"Oligo Pool","description":"Pool or library of ssDNA oligos. May contain one or more sublibraries. In array fields, the n-th position corresponds to n-th sublibrary. \"forward priming site\" and \"reverse priming site\" are read as primer sequences.","created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2019-01-23T16:24:45.000-08:00","field_types":[{"id":3947,"parent_id":75,"name":"Manufacturer","ftype":"string","choices":null,"array":false,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-07T09:48:57.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3948,"parent_id":75,"name":"Oligo Library ID","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-07T09:48:57.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3949,"parent_id":75,"name":"inner forward primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1763,"field_type_id":3949,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3950,"parent_id":75,"name":"inner reverse primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1764,"field_type_id":3950,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3951,"parent_id":75,"name":"sublibrary forward primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1765,"field_type_id":3951,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3952,"parent_id":75,"name":"sublibrary reverse primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1766,"field_type_id":3952,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3953,"parent_id":75,"name":"min length (nt) (array)","ftype":"number","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3954,"parent_id":75,"name":"max length (nt) (array)","ftype":"number","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3955,"parent_id":75,"name":"variants (array)","ftype":"number","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3964,"parent_id":75,"name":"sublibrary name (array)","ftype":"string","choices":null,"array":true,"required":true,"created_at":"2018-06-05T14:37:16.000-07:00","updated_at":"2018-06-05T14:37:16.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":7477,"parent_id":75,"name":"forward priming site (array)","ftype":"string","choices":null,"array":true,"required":true,"created_at":"2019-01-23T16:24:45.000-08:00","updated_at":"2019-01-23T16:24:45.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":7478,"parent_id":75,"name":"reverse priming site (array)","ftype":"string","choices":null,"array":true,"required":true,"created_at":"2019-01-23T16:24:45.000-08:00","updated_at":"2019-01-23T16:24:45.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]}]},{"id":15,"name":"Media","description":"Media for yeast and E. coli","created_at":"2015-12-16T14:13:57.000-08:00","updated_at":"2015-12-16T14:35:10.000-08:00","field_types":[]}],"object_types":[{"id":350,"name":"Yeast Plate","description":"Yeast Plate","min":0,"max":100000,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2014-02-13T14:04:32.000-08:00","updated_at":"2015-03-02T10:44:55.000-08:00","unit":"Yeast Strain","cost":1.0,"release_method":"return","release_description":"","sample_type_id":5,"image":"","prefix":"DFP","rows":null,"columns":null,"sample_type_name":"Yeast Strain"},{"id":746,"name":"Yeast Library Glycerol Stock","description":"A special case of glycerol stock that contains a strain library.","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2018-01-02T14:29:57.000-08:00","updated_at":"2018-01-11T14:42:01.000-08:00","unit":"DNA Library","cost":0.01,"release_method":"dispose","release_description":"","sample_type_id":70,"image":"","prefix":"M80","rows":null,"columns":null,"sample_type_name":"DNA Library"},{"id":747,"name":"Labeled Yeast Library Suspension","description":"Yeast library labeled with dye-conjugated antibody (e.g., anti-Myc-FITC)","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2018-01-02T14:30:54.000-08:00","updated_at":"2018-01-02T14:30:54.000-08:00","unit":"DNA Library","cost":0.01,"release_method":"return","release_description":"","sample_type_id":70,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"DNA Library"},{"id":461,"name":"Divided Yeast Plate","description":"Divided Yeast Plate","min":0,"max":10000,"handler":"collection","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2015-05-10T16:47:47.000-07:00","updated_at":"2017-07-20T09:39:45.000-07:00","unit":"plate","cost":1.0,"release_method":"return","release_description":"","sample_type_id":null,"image":"","prefix":"DFP","rows":1,"columns":4,"sample_type_name":null},{"id":466,"name":"800 mL Liquid","description":"800 mL Bottle","min":0,"max":10000,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":" {\r\n    \"samples\": [\r\n      { \"name\": \"SC\",   \"materials\": 0.0135, \"labor\": 0.028, \"delete\": false, \"unit\": \"mL\", \"total_volume\": 800 },\r\n      { \"name\": \"SDO\",  \"materials\": 0.014, \"labor\": 0.028, \"delete\": false, \"unit\": \"mL\", \"total_volume\": 800 },\r\n      { \"name\": \"50% Glycerol\",   \"materials\": 0.02, \"labor\": 0.02, \"delete\": false, \"unit\": \"mL\", \"total_volume\": 800 },\r\n      { \"name\": \"TB\",   \"materials\": 0.01, \"labor\": 0.016, \"delete\": false, \"unit\": \"mL\", \"total_volume\": 800 },\r\n      { \"name\": \"TB + Amp\",   \"materials\": 0.03, \"labor\": 0.028, \"delete\": false, \"unit\": \"mL\", \"total_volume\": 800 },\r\n      { \"name\": \"LB\",   \"materials\": 0.01, \"labor\": 0.016, \"delete\": false, \"unit\": \"mL\", \"total_volume\": 800 },     \r\n      { \"name\": \"YPAD\", \"materials\": 0.01, \"labor\": 0.025, \"delete\": false, \"unit\": \"mL\", \"total_volume\": 800 }\r\n    ]\r\n  }","vendor":"No vendor information","created_at":"2015-12-16T14:35:46.000-08:00","updated_at":"2017-06-13T11:30:03.000-07:00","unit":"Media","cost":0.01,"release_method":"return","release_description":"","sample_type_id":15,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"Media"},{"id":740,"name":"Yeast 5ml culture","description":"A 5 ml yeast culture in a 15 ml glass culture tube","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2017-12-18T12:01:59.000-08:00","updated_at":"2017-12-18T12:01:59.000-08:00","unit":"Yeast Strain","cost":0.01,"release_method":"return","release_description":"","sample_type_id":5,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"Yeast Strain"},{"id":748,"name":"Yeast Library Liquid Culture","description":"A special case of yeast culture that contains a strain library","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2018-01-02T14:33:08.000-08:00","updated_at":"2018-01-02T14:33:08.000-08:00","unit":"DNA Library","cost":0.01,"release_method":"return","release_description":"","sample_type_id":70,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"DNA Library"}],"operation_type":{"name":"Innoculate Yeast Library","category":"Yeast Display","deployed":false,"on_the_fly":false,"field_types":[{"ftype":"sample","role":"input","name":"Yeast Culture","sample_types":["Yeast Strain","DNA Library","DNA Library","Yeast Strain"],"object_types":["Yeast Plate","Yeast Library Glycerol Stock","Labeled Yeast Library Suspension","Divided Yeast Plate"],"part":false,"array":false,"routing":"YL","preferred_operation_type_id":42,"preferred_field_type_id":212,"choices":null},{"ftype":"sample","role":"input","name":"Media","sample_types":["Media"],"object_types":["800 mL Liquid"],"part":false,"array":false,"routing":"M","preferred_operation_type_id":178,"preferred_field_type_id":699,"choices":null},{"ftype":"sample","role":"output","name":"Yeast Culture","sample_types":["Yeast Strain","DNA Library"],"object_types":["Yeast 5ml culture","Yeast Library Liquid Culture"],"part":false,"array":false,"routing":"YL","preferred_operation_type_id":null,"preferred_field_type_id":null,"choices":null},{"ftype":"json","role":"input","name":"Options","sample_types":[],"object_types":[],"part":false,"array":false,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"choices":null}],"protocol":"# Devin Strickland\n# dvn.strcklnd@gmail.com\n\nneeds \"Yeast Display/YeastDisplayShows\"\nneeds \"Yeast Display/YeastDisplayHelper\"\nneeds \"Standard Libs/SortHelper\"\n\nclass Protocol\n\n    include YeastDisplayShows, YeastDisplayHelper, SortHelper\n\n    INPUT_YEAST = 'Yeast Culture'\n\n    def main\n\n        # DO NOT DELETE SORT BY ID\n        ops_sorted=sortByMultipleIO(operations, [\"in\"], [INPUT_YEAST], [\"id\"], [\"item\"])\n        operations=ops_sorted\n\n        set_test_labels(operations.map { |op| op.input(INPUT_YEAST).item }) if debug\n\n        group_ops_by_container.each do |container, container_group|\n            container_group.retrieve.make\n            prepare_media_and_dilute(container, container_group)\n        end\n\n        return_to_incubator\n\n        input_items = operations.map { |op| op.input(INPUT_YEAST).item }\n\n        discards = input_items.reject { |i| i.object_type.name =~ /(plate|glycerol)/i }\n\n        mark_cultures_for_discard(discards)\n\n        glycerol_stocks = input_items.select { |i| i.object_type.name =~ /(Yeast Library Glycerol Stock)/i }\n        glycerol_stocks.map { |i| i.mark_as_deleted }\n\n        show do\n            title \"Throw Away Glycerol Stocks\"\n\n            note \"Throw away all the \u003cb\u003eempty\u003c/b\u003e glycerol stocks (#{glycerol_stocks.map { |i| i.to_s }.to_sentence}).\"\n        end\n\n        operations.store\n\n        # DO NOT DELETE\n        operations.each { |op|\n            if( !(op.input(INPUT_YEAST).item.get(:bin).nil?) ) # sorted sample\n                op.output(OUTPUT_YEAST).item.associate(:bin, op.input(INPUT_YEAST).item.get(:bin))\n            end\n        }\n\n        # library glycerol stocks need to be deleted\n    end\n\nend","precondition":"require 'date'\nrequire 'json'\n\ndef precondition(op)\n    return true unless op.input('Options')\n    \n    opts = JSON.parse(op.input('Options').value, { symbolize_names: true })\n    \n    return true unless opts[:delay_until]\n    \n    if opts[:delay_until] =~ /\\d{2}\\/\\d{2}\\/\\d{2}/\n        frmt = \"%m/%d/%y\"\n    elsif opts[:delay_until] =~ /\\d{4}-\\d{2}-\\d{2}/\n        frmt = \"%Y-%m-%d\"\n    else\n        return true\n    end\n    \n    Time.now \u003e= Time.strptime(opts[:delay_until], frmt)\nend","cost_model":"def cost(op)\n   if (op.output(\"Yeast Culture\").object_type.try(:name) == \"Yeast 5ml culture\")\n     { labor: 4.012, materials: 0.7 }\n   elsif (op.output(\"Yeast Culture\").object_type.try(:name) == \"Yeast Library Liquid Culture\")\n     { labor: 4.012, materials: 2.06 }\n   end\n   \nend","documentation":"Documentation here. Start with a paragraph, not a heading or title, as in most views, the title will be supplied by the view.","test":"","timing":null}},{"sample_types":[],"object_types":[],"operation_type":{"name":"Mass Plan Data Upload","category":"Yeast Display","deployed":false,"on_the_fly":false,"field_types":[],"protocol":"class Protocol\n\n  def main\n    data_associations = []\n    operations.each do |op|\n        jobs = jobs_from_plan(op.plan)\n        \n        show do\n          title \"Access Network Drive\"\n          note \"Open a connection to the samba share drive where the experimental results live\"\n          warning \"smb://128.95.114.54\"\n        end\n        \n        jobs.each do |j|\n          op_type = j.operations.first.operation_type.name \n          if op_type == 'Sort Yeast Display Library'\n              data_associations.concat(lazy_associate_fcs_uploads(j, \"fcs_measurement\", get_fcs_uploads(j))) # gets uploads, makes new associations from uploads, concats these associations to complete association list\n          end\n        end\n        \n        show do\n          title \"Sorting Files\"\n          note \"Next we will upload the sorting files for each job.\"\n          note \"You will need to manually inspect the contents of some files before uploading\"\n          note \"To make this easier, open \\\"128.95.114.54/Data/Aria/dstrickland/Sort Reports\\\" in a seperate file window where you can click around and open files\"\n        end\n        \n        jobs.each do |j|\n          op_type = j.operations.first.operation_type.name \n          if op_type == 'Sort Yeast Display Library'\n              data_associations.concat(lazy_associate_sorting_uploads(j, \"sort_report\", get_sorting_uploads(j)))\n          end\n        end\n    end\n    DataAssociation.import data_associations, on_duplicate_key_update: [:object] unless data_associations.empty?\n  end\n  \n  def get_fcs_uploads(j)\n    id = j.id\n    date = j.updated_at.strftime('%d%m%Y')\n    resp = show do\n      title \"Locate FCS Files\"\n      note \"On the Samba drive:\"\n      bullet \"Navigate to the shared folder: 128.95.114.54/Data/Aria/dstrickland\"\n      bullet \"Within that folder, navigate to the sub folder with name #{date}\"\n      bullet \"Within that folder, ensure that the only folder inside has the filename: Job_#{id}, open up this innermost folder\"\n      check \"Now upload all FCS measurement files related to job #{id}\"\n      upload var: \"fcs_uploads\"\n    end\n    \n    resp.get_response(:fcs_uploads)\n  end\n  \n  def get_sorting_uploads(j)\n    id = j.id\n    date = j.updated_at\n    resp = show do\n      title \"Locate Sorting xml files\"\n      note \"On the Samba drive, through a seperate file explorer window:\"\n      bullet \"Navigate to the shared folder: 128.95.114.54/Data/Aria/dstrickland/Sort Reports\"\n      bullet \"within that folder, navigate to the sub folder with the date accessed: #{date}\"\n      bullet \"within that folder, open any of the .xml files, ensure that somewhere on one of the first few lines of the file it says: \\\"Job_#{id}\\\"\"\n      check \"Now open that same folder address with the upload selector and upload all XML files related to job #{id}\"\n      upload var: \"sorting_uploads\"\n    end\n    \n    resp.get_response(:sorting_uploads)\n  end\n  \n  def lazy_associate_fcs_uploads(j, key_prefix, data_uploads)\n    das = []\n    if data_uploads\n      j.operations.each do |op|\n        data_uploads.each_with_index do |up|\n          tube_id = op.output(\"Labeled Yeast Library\").item.get(\"software_tube_id\")\n          if (up.name.include? tube_id)\n            (op.inputs).each do |fv|\n              das \u003c\u003c lazy_associate2(fv.item, key_prefix, {}, up) if fv.item\n            end\n            das \u003c\u003c lazy_associate2(op, key_prefix, {}, up)\n          end\n        end\n      end\n    end\n    das\n  end\n  \n  def lazy_associate_sorting_uploads(j, key_prefix, data_uploads)\n    das = []\n    if data_uploads\n      j.operations.each do |op|\n        data_uploads.each_with_index do |up|\n          tube_id = op.output(\"Labeled Yeast Library\").item.get(\"software_tube_id\")\n          if (up.name.include? tube_id) || (open(up.url).read.include? tube_id)\n            das \u003c\u003c lazy_associate2(op, key_prefix, {}, up)\n          end\n        end\n      end\n    end\n    das\n  end\n  \n  def jobs_from_plan(plan)\n    plan.operations.map { |op| op.jobs.last }.uniq\n  end\n  \n  def lazy_associate2(op, key, value, upload = nil)\n   da = DataAssociation.new(\n    parent_id: op.id,\n    parent_class: op.class.to_s,\n    key: key.to_s,\n    object: { key =\u003e value }.to_json,\n    upload_id: upload ? upload.id : nil\n  )\n  end\nend\n","precondition":"def precondition(operation)\n  # this protocol only begins if all other operations in the plan have completed\n  all_ops = operation.plan.operations - [operation]\n  if all_ops.empty? || !(all_ops.all? { |op| op.status == 'done' || op.status == 'error'})\n    operation.associate(\"Waiting on rest of plan\", \"This operation is meant to be run after all other operations in the plan are finished\")\n    return false\n  else\n    operation.get_association(\"Waiting on rest of plan\").delete if operation.get_association(\"Waiting on rest of plan\")\n    return true\n  end\nend","cost_model":"def cost(_op)\n  { labor: 0, materials: 0 }\nend","documentation":"Documentation here. Start with a paragraph, not a heading or title, as in most views, the title will be supplied by the view.","test":"","timing":null}},{"sample_types":[{"id":70,"name":"DNA Library","description":"A sample that contains a pool of DNA molecules with many unique sequences","created_at":"2018-01-02T14:28:12.000-08:00","updated_at":"2018-01-02T14:28:12.000-08:00","field_types":[{"id":3965,"parent_id":70,"name":"Oligo Pool","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2018-06-05T14:45:01.000-07:00","updated_at":"2018-06-05T14:45:01.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1772,"field_type_id":3965,"sample_type_id":75,"object_type_id":null,"created_at":"2018-06-05T14:45:01.000-07:00","updated_at":"2018-06-05T14:45:01.000-07:00","sample_type":{"id":75,"name":"Oligo Pool","description":"Pool or library of ssDNA oligos. May contain one or more sublibraries. In array fields, the n-th position corresponds to n-th sublibrary. \"forward priming site\" and \"reverse priming site\" are read as primer sequences.","created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2019-01-23T16:24:45.000-08:00"}}],"sample_types":["Oligo Pool"],"object_types":[null]}]},{"id":75,"name":"Oligo Pool","description":"Pool or library of ssDNA oligos. May contain one or more sublibraries. In array fields, the n-th position corresponds to n-th sublibrary. \"forward priming site\" and \"reverse priming site\" are read as primer sequences.","created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2019-01-23T16:24:45.000-08:00","field_types":[{"id":3947,"parent_id":75,"name":"Manufacturer","ftype":"string","choices":null,"array":false,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-07T09:48:57.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3948,"parent_id":75,"name":"Oligo Library ID","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-07T09:48:57.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3949,"parent_id":75,"name":"inner forward primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1763,"field_type_id":3949,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3950,"parent_id":75,"name":"inner reverse primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1764,"field_type_id":3950,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3951,"parent_id":75,"name":"sublibrary forward primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1765,"field_type_id":3951,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3952,"parent_id":75,"name":"sublibrary reverse primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1766,"field_type_id":3952,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3953,"parent_id":75,"name":"min length (nt) (array)","ftype":"number","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3954,"parent_id":75,"name":"max length (nt) (array)","ftype":"number","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3955,"parent_id":75,"name":"variants (array)","ftype":"number","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3964,"parent_id":75,"name":"sublibrary name (array)","ftype":"string","choices":null,"array":true,"required":true,"created_at":"2018-06-05T14:37:16.000-07:00","updated_at":"2018-06-05T14:37:16.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":7477,"parent_id":75,"name":"forward priming site (array)","ftype":"string","choices":null,"array":true,"required":true,"created_at":"2019-01-23T16:24:45.000-08:00","updated_at":"2019-01-23T16:24:45.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":7478,"parent_id":75,"name":"reverse priming site (array)","ftype":"string","choices":null,"array":true,"required":true,"created_at":"2019-01-23T16:24:45.000-08:00","updated_at":"2019-01-23T16:24:45.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]}]},{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00","field_types":[{"id":1,"parent_id":1,"name":"Overhang Sequence","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":2,"parent_id":1,"name":"Anneal Sequence","ftype":"string","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3,"parent_id":1,"name":"T Anneal","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]}]}],"object_types":[{"id":748,"name":"Yeast Library Liquid Culture","description":"A special case of yeast culture that contains a strain library","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2018-01-02T14:33:08.000-08:00","updated_at":"2018-01-02T14:33:08.000-08:00","unit":"DNA Library","cost":0.01,"release_method":"return","release_description":"","sample_type_id":70,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"DNA Library"}],"operation_type":{"name":"Mix Cultures","category":"Yeast Display","deployed":false,"on_the_fly":false,"field_types":[{"ftype":"sample","role":"input","name":"Component Yeast Culture","sample_types":["DNA Library"],"object_types":["Yeast Library Liquid Culture"],"part":false,"array":true,"routing":null,"preferred_operation_type_id":361,"preferred_field_type_id":1471,"choices":null},{"ftype":"json","role":"input","name":"Proportions","sample_types":[],"object_types":[],"part":false,"array":false,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"choices":null},{"ftype":"sample","role":"output","name":"Yeast Culture","sample_types":["DNA Library"],"object_types":["Yeast Library Liquid Culture"],"part":false,"array":false,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"choices":null}],"protocol":"# frozen_string_literal: true\n\n# @author Devin Strickland\n# @email dvn.strcklnd@gmail.com\n\nneeds 'Yeast Display/YeastDisplayHelper'\nneeds 'Standard Libs/AssociationManagement'\nneeds 'Standard Libs/Debug'\n\nclass Protocol\n  include AssociationManagement\n  include Debug\n  include PartProvenance\n  include YeastDisplayHelper\n\n  INPUT_YEAST = 'Component Yeast Culture'\n  PROPORTIONS = 'Proportions'\n\n  def main\n    operations.retrieve.make\n    discard_items = []\n\n    operations.each do |op|\n      discard_items += operation_mix(op)\n    end\n\n    discard_items.uniq!\n    mark_cultures_for_discard(discard_items)\n    release(discard_items, interactive: true)\n  end\n\n  def operation_mix(operation)\n    input_cultures = operation.input_array(INPUT_YEAST).items\n    proportions = operation.input(PROPORTIONS).value.scan(/[\\d\\.]+/)\n\n    mix_table = create_mix_table(cultures: input_cultures,\n                                 proportions: proportions)\n    show_mix(mix_table)\n    add_culture_provenance(cultures: input_cultures,\n                           culture_mix: operation.output('Yeast Culture').item,\n                           proportions: proportions)\n\n    input_cultures\n  end\n\n  def create_mix_table(cultures:, proportions:)\n    mix_table = [[\"#{INPUT_YEAST} Item ID\", PROPORTIONS]]\n    culture_ids = cultures.map(\u0026:id)\n\n    mix_table + [culture_ids, proportions].transpose\n  end\n\n  def show_mix(mix_table)\n    # TODO: make \"not very different\" more exact\n    # TODO: be more detailed about how to do proportional mixing\n    show do\n      title 'Mix cultures'\n\n      note 'Inspect the cultures to make sure the ODs are not very different'\n      note 'If they are very different, then dilute the higher density ' \\\n           'culture to the same OD as the lower density one'\n      note 'Once the ODs are close, mix the cultures according to the ' \\\n           'following proportions'\n      table mix_table\n    end\n  end\n\n  # Adds provenance to the input and output cultures for this Mix Cultures.\n  # Includes the proportion of each input in the mix as an attribute.\n  #\n  # @param cultures [Array\u003cItem\u003e]  the array of input cultures\n  # @param culture_mix [Item]  the output culture\n  # @param proportions [Array\u003cFloat\u003e]  the proportion array\n  def add_culture_provenance(cultures:, culture_mix:, proportions:)\n    mix_associations = AssociationMap.new(culture_mix)\n    cultures.each_with_index do |culture, index|\n      culture_associations = AssociationMap.new(culture)\n      proportion = { proportion: proportions[index] }\n      add_provenance(from: culture, from_map: culture_associations,\n                     to: culture_mix, to_map: mix_associations,\n                     additional_relation_data: proportion)\n      culture_associations.save\n    end\n    mix_associations.save\n  end\nend\n","precondition":"def precondition(_op)\n  true\nend","cost_model":"def cost(_op)\n  { labor: 13.95, materials: 0.23 }\nend","documentation":"Documentation here. Start with a paragraph, not a heading or title, as in most views, the title will be supplied by the view.","test":"","timing":null}},{"sample_types":[{"id":5,"name":"Yeast Strain","description":"A strain of yeast distinguished from others by genomic or plasmid modifications","created_at":"2013-10-16T14:37:29.000-07:00","updated_at":"2015-12-08T17:40:57.000-08:00","field_types":[{"id":18,"parent_id":5,"name":"Parent","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-25T08:43:19.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":8,"field_type_id":18,"sample_type_id":5,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":5,"name":"Yeast Strain","description":"A strain of yeast distinguished from others by genomic or plasmid modifications","created_at":"2013-10-16T14:37:29.000-07:00","updated_at":"2015-12-08T17:40:57.000-08:00"}}],"sample_types":["Yeast Strain"],"object_types":[null]},{"id":19,"parent_id":5,"name":"Integrant","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":9,"field_type_id":19,"sample_type_id":2,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":2,"name":"Plasmid","description":"A circular piece of double stranded DNA","created_at":"2013-10-15T09:59:25.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":10,"field_type_id":19,"sample_type_id":4,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Plasmid","Fragment"],"object_types":[null,null]},{"id":20,"parent_id":5,"name":"Plasmid","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":11,"field_type_id":20,"sample_type_id":2,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":2,"name":"Plasmid","description":"A circular piece of double stranded DNA","created_at":"2013-10-15T09:59:25.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Plasmid"],"object_types":[null]},{"id":21,"parent_id":5,"name":"Integrated Marker(s)","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":22,"parent_id":5,"name":"Plasmid Marker(s)","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":23,"parent_id":5,"name":"Mating Type","ftype":"string","choices":"MATa,MATalpha,Diploid","array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-10T09:05:01.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":24,"parent_id":5,"name":"QC Primer1","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":12,"field_type_id":24,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":25,"parent_id":5,"name":"QC Primer2","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:23:30.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":13,"field_type_id":25,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":43,"parent_id":5,"name":"QC_length","ftype":"number","choices":"","array":false,"required":false,"created_at":"2016-05-20T14:29:39.000-07:00","updated_at":"2016-05-20T14:35:37.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":44,"parent_id":5,"name":"Comp_cell_limit","ftype":"string","choices":"Yes,No","array":false,"required":false,"created_at":"2016-05-20T14:35:37.000-07:00","updated_at":"2016-05-20T14:35:37.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":83,"parent_id":5,"name":"Media","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2017-07-12T19:25:25.000-07:00","updated_at":"2017-07-12T19:25:25.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":954,"parent_id":5,"name":"Has this strain passed QC?","ftype":"string","choices":"No,Yes","array":false,"required":false,"created_at":"2017-10-31T11:39:27.000-07:00","updated_at":"2017-10-31T20:14:46.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":6455,"parent_id":5,"name":"Haploids","ftype":"sample","choices":null,"array":true,"required":false,"created_at":"2018-10-24T19:01:40.000-07:00","updated_at":"2018-10-24T19:01:40.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":2669,"field_type_id":6455,"sample_type_id":5,"object_type_id":null,"created_at":"2018-10-24T19:01:40.000-07:00","updated_at":"2018-10-24T19:01:40.000-07:00","sample_type":{"id":5,"name":"Yeast Strain","description":"A strain of yeast distinguished from others by genomic or plasmid modifications","created_at":"2013-10-16T14:37:29.000-07:00","updated_at":"2015-12-08T17:40:57.000-08:00"}}],"sample_types":["Yeast Strain"],"object_types":[null]}]},{"id":2,"name":"Plasmid","description":"A circular piece of double stranded DNA","created_at":"2013-10-15T09:59:25.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00","field_types":[{"id":4,"parent_id":2,"name":"Sequence","ftype":"url","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:30:08.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":5,"parent_id":2,"name":"Sequence Verification","ftype":"url","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:16:33.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":6,"parent_id":2,"name":"Bacterial Marker","ftype":"string","choices":"Amp,Kan,Amp + Kan,Spec,Kan + Spec,Chlor,Tet,NA,Other","array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2017-12-27T11:26:31.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":7,"parent_id":2,"name":"Yeast Marker","ftype":"string","choices":"HIS,TRP,URA,LEU,NatMX,KanMX,HygMX,BleoMX,5FOA,NA,Other","array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2017-02-13T10:49:58.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":27,"field_type_id":7,"sample_type_id":1,"object_type_id":null,"created_at":"2017-02-13T10:49:58.000-08:00","updated_at":"2017-02-13T10:49:58.000-08:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":8,"parent_id":2,"name":"Length","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:16:33.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":42,"parent_id":2,"name":"Sequencing Primers","ftype":"sample","choices":null,"array":true,"required":false,"created_at":"2016-05-09T21:30:48.000-07:00","updated_at":"2016-05-09T21:30:48.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":26,"field_type_id":42,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T21:30:48.000-07:00","updated_at":"2016-05-09T21:30:48.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":46,"parent_id":2,"name":"QC Primer1","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":29,"field_type_id":46,"sample_type_id":1,"object_type_id":null,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":47,"parent_id":2,"name":"QC Primer2","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":30,"field_type_id":47,"sample_type_id":1,"object_type_id":null,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":48,"parent_id":2,"name":"QC_length","ftype":"number","choices":null,"array":false,"required":false,"created_at":"2017-05-24T14:51:40.000-07:00","updated_at":"2017-05-24T14:51:40.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":5816,"parent_id":2,"name":"Transformation Temperature","ftype":"number","choices":"37,30","array":false,"required":false,"created_at":"2018-09-17T15:02:22.000-07:00","updated_at":"2018-11-06T11:31:23.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":16203,"parent_id":2,"name":"Comp Cells","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2020-02-14T10:28:40.000-08:00","updated_at":"2020-02-14T10:28:40.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":3108,"field_type_id":16203,"sample_type_id":3,"object_type_id":null,"created_at":"2020-02-14T10:28:40.000-08:00","updated_at":"2020-02-14T10:28:40.000-08:00","sample_type":{"id":3,"name":"E coli strain","description":"A strain of E coli distinguished from others by genomic (not plasmid) modifications.","created_at":"2013-10-15T10:16:52.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["E coli strain"],"object_types":[null]}]},{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00","field_types":[{"id":1,"parent_id":1,"name":"Overhang Sequence","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":2,"parent_id":1,"name":"Anneal Sequence","ftype":"string","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3,"parent_id":1,"name":"T Anneal","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]}]},{"id":3,"name":"E coli strain","description":"A strain of E coli distinguished from others by genomic (not plasmid) modifications.","created_at":"2013-10-15T10:16:52.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00","field_types":[{"id":10,"parent_id":3,"name":"Parent","ftype":"sample","choices":null,"array":null,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1,"field_type_id":10,"sample_type_id":3,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":3,"name":"E coli strain","description":"A strain of E coli distinguished from others by genomic (not plasmid) modifications.","created_at":"2013-10-15T10:16:52.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["E coli strain"],"object_types":[null]}]},{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00","field_types":[{"id":11,"parent_id":4,"name":"Sequence","ftype":"url","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:17:39.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":12,"parent_id":4,"name":"Length","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:17:39.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":13,"parent_id":4,"name":"Template","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-12T19:07:59.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":2,"field_type_id":13,"sample_type_id":2,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":2,"name":"Plasmid","description":"A circular piece of double stranded DNA","created_at":"2013-10-15T09:59:25.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":3,"field_type_id":13,"sample_type_id":3,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":3,"name":"E coli strain","description":"A strain of E coli distinguished from others by genomic (not plasmid) modifications.","created_at":"2013-10-15T10:16:52.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":4,"field_type_id":13,"sample_type_id":4,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":5,"field_type_id":13,"sample_type_id":5,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":5,"name":"Yeast Strain","description":"A strain of yeast distinguished from others by genomic or plasmid modifications","created_at":"2013-10-16T14:37:29.000-07:00","updated_at":"2015-12-08T17:40:57.000-08:00"}},{"id":2547,"field_type_id":13,"sample_type_id":70,"object_type_id":null,"created_at":"2018-09-18T16:02:54.000-07:00","updated_at":"2018-09-18T16:02:54.000-07:00","sample_type":{"id":70,"name":"DNA Library","description":"A sample that contains a pool of DNA molecules with many unique sequences","created_at":"2018-01-02T14:28:12.000-08:00","updated_at":"2018-01-02T14:28:12.000-08:00"}}],"sample_types":["Plasmid","E coli strain","Fragment","Yeast Strain","DNA Library"],"object_types":[null,null,null,null,null]},{"id":14,"parent_id":4,"name":"Forward Primer","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-12T19:07:59.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":6,"field_type_id":14,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":2664,"field_type_id":14,"sample_type_id":4,"object_type_id":null,"created_at":"2018-10-22T13:03:32.000-07:00","updated_at":"2018-10-22T13:03:32.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer","Fragment"],"object_types":[null,null]},{"id":15,"parent_id":4,"name":"Reverse Primer","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-12T19:07:59.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":7,"field_type_id":15,"sample_type_id":1,"object_type_id":null,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T20:40:31.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":2665,"field_type_id":15,"sample_type_id":4,"object_type_id":null,"created_at":"2018-10-22T13:03:32.000-07:00","updated_at":"2018-10-22T13:03:32.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer","Fragment"],"object_types":[null,null]},{"id":16,"parent_id":4,"name":"Restriction Enzyme(s)","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:17:39.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":17,"parent_id":4,"name":"Yeast Marker","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:17:39.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":6423,"parent_id":4,"name":"Fragment Mix Array","ftype":"sample","choices":null,"array":true,"required":false,"created_at":"2018-10-23T13:35:15.000-07:00","updated_at":"2018-10-24T11:05:59.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":2667,"field_type_id":6423,"sample_type_id":1,"object_type_id":null,"created_at":"2018-10-23T13:35:15.000-07:00","updated_at":"2018-10-23T13:35:15.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}},{"id":2668,"field_type_id":6423,"sample_type_id":4,"object_type_id":null,"created_at":"2018-10-23T13:35:15.000-07:00","updated_at":"2018-10-23T13:35:15.000-07:00","sample_type":{"id":4,"name":"Fragment","description":"A linear double stranded piece of DNA from PCR or Restriction Digest","created_at":"2013-10-16T14:33:41.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer","Fragment"],"object_types":[null,null]}]},{"id":70,"name":"DNA Library","description":"A sample that contains a pool of DNA molecules with many unique sequences","created_at":"2018-01-02T14:28:12.000-08:00","updated_at":"2018-01-02T14:28:12.000-08:00","field_types":[{"id":3965,"parent_id":70,"name":"Oligo Pool","ftype":"sample","choices":null,"array":false,"required":false,"created_at":"2018-06-05T14:45:01.000-07:00","updated_at":"2018-06-05T14:45:01.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1772,"field_type_id":3965,"sample_type_id":75,"object_type_id":null,"created_at":"2018-06-05T14:45:01.000-07:00","updated_at":"2018-06-05T14:45:01.000-07:00","sample_type":{"id":75,"name":"Oligo Pool","description":"Pool or library of ssDNA oligos. May contain one or more sublibraries. In array fields, the n-th position corresponds to n-th sublibrary. \"forward priming site\" and \"reverse priming site\" are read as primer sequences.","created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2019-01-23T16:24:45.000-08:00"}}],"sample_types":["Oligo Pool"],"object_types":[null]}]},{"id":75,"name":"Oligo Pool","description":"Pool or library of ssDNA oligos. May contain one or more sublibraries. In array fields, the n-th position corresponds to n-th sublibrary. \"forward priming site\" and \"reverse priming site\" are read as primer sequences.","created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2019-01-23T16:24:45.000-08:00","field_types":[{"id":3947,"parent_id":75,"name":"Manufacturer","ftype":"string","choices":null,"array":false,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-07T09:48:57.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3948,"parent_id":75,"name":"Oligo Library ID","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-07T09:48:57.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3949,"parent_id":75,"name":"inner forward primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1763,"field_type_id":3949,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3950,"parent_id":75,"name":"inner reverse primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1764,"field_type_id":3950,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3951,"parent_id":75,"name":"sublibrary forward primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1765,"field_type_id":3951,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3952,"parent_id":75,"name":"sublibrary reverse primer (array)","ftype":"sample","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[{"id":1766,"field_type_id":3952,"sample_type_id":1,"object_type_id":null,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","sample_type":{"id":1,"name":"Primer","description":"A short double stranded piece of DNA for PCR and sequencing","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2015-11-29T07:55:20.000-08:00"}}],"sample_types":["Primer"],"object_types":[null]},{"id":3953,"parent_id":75,"name":"min length (nt) (array)","ftype":"number","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3954,"parent_id":75,"name":"max length (nt) (array)","ftype":"number","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3955,"parent_id":75,"name":"variants (array)","ftype":"number","choices":null,"array":true,"required":true,"created_at":"2018-06-05T11:30:26.000-07:00","updated_at":"2018-06-05T11:30:26.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3964,"parent_id":75,"name":"sublibrary name (array)","ftype":"string","choices":null,"array":true,"required":true,"created_at":"2018-06-05T14:37:16.000-07:00","updated_at":"2018-06-05T14:37:16.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":7477,"parent_id":75,"name":"forward priming site (array)","ftype":"string","choices":null,"array":true,"required":true,"created_at":"2019-01-23T16:24:45.000-08:00","updated_at":"2019-01-23T16:24:45.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":7478,"parent_id":75,"name":"reverse priming site (array)","ftype":"string","choices":null,"array":true,"required":true,"created_at":"2019-01-23T16:24:45.000-08:00","updated_at":"2019-01-23T16:24:45.000-08:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]}]}],"object_types":[{"id":741,"name":"Labeled Yeast Strain Suspension","description":"A yeast strain that has been labeled for flow cytometry","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2017-12-18T12:05:31.000-08:00","updated_at":"2017-12-18T12:05:31.000-08:00","unit":"Yeast Strain","cost":0.01,"release_method":"return","release_description":"","sample_type_id":5,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"Yeast Strain"},{"id":747,"name":"Labeled Yeast Library Suspension","description":"Yeast library labeled with dye-conjugated antibody (e.g., anti-Myc-FITC)","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"No data","vendor":"No vendor information","created_at":"2018-01-02T14:30:54.000-08:00","updated_at":"2018-01-02T14:30:54.000-08:00","unit":"DNA Library","cost":0.01,"release_method":"return","release_description":"","sample_type_id":70,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"DNA Library"}],"operation_type":{"name":"Sort Yeast Display Library","category":"Yeast Display","deployed":false,"on_the_fly":false,"field_types":[{"ftype":"sample","role":"input","name":"Labeled Yeast Library","sample_types":["Yeast Strain","DNA Library"],"object_types":["Labeled Yeast Strain Suspension","Labeled Yeast Library Suspension"],"part":false,"array":false,"routing":"YL","preferred_operation_type_id":363,"preferred_field_type_id":1479,"choices":null},{"ftype":"sample","role":"output","name":"Labeled Yeast Library","sample_types":["Yeast Strain","DNA Library"],"object_types":["Labeled Yeast Strain Suspension","Labeled Yeast Library Suspension"],"part":false,"array":false,"routing":"YL","preferred_operation_type_id":null,"preferred_field_type_id":null,"choices":null},{"ftype":"string","role":"input","name":"Control?","sample_types":[],"object_types":[],"part":false,"array":false,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"choices":"no,autofluorescence,high-fitc,high-pe,protease"},{"ftype":"string","role":"input","name":"Sort?","sample_types":[],"object_types":[],"part":false,"array":false,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"choices":"no,yes"}],"protocol":"# Devin Strickland\n# dvn.strcklnd@gmail.com\n\nneeds \"Yeast Display/YeastDisplayHelper\"\nneeds \"Standard Libs/Debug\"\nneeds \"Standard Libs/PlanParams\"\nneeds \"Flow Cytometry/SonySH800S\"\nneeds \"Flow Cytometry/BDAriaIII\"\n\nclass Protocol\n\n    include Debug, PlanParams\n    include Cytometers::SonySH800S, Cytometers::BDAriaIII\n    include YeastDisplayHelper\n\n    attr_accessor :now_sorting, :tube_ct\n\n    INPUT_YEAST = 'Labeled Yeast Library'\n    OUTPUT_YEAST = 'Labeled Yeast Library'\n\n    RESUSPENSION_BUFFER = 'PBSF'\n\n    MICROFUGE_TUBE = '1.5 ml microfuge tube'\n    COLLECTION_TUBE = '15 ml polypropylene conical tube'\n    SAMPLE_TUBE = '5 ml polystyrene round-bottom tube'\n\n    CALIBRATION_BEADS = \"SpheroTech ultra rainbow\"\n    CALIBRATION_BEAD_VOLUME = { qty: 250, units: MICROLITERS }\n    CALIBRATION_BEADS_LABEL = 'beads'\n    BEAD_CAP_COLORS = ['brown', 'white']\n\n    AUTOFLUORESCENCE_CONTROL = 'autofluorescence'\n    HIGH_FITC_CONTROL = 'high-fitc'\n    HIGH_PE_CONTROL = 'high-pe'\n    PROTEASE_CONTROL = 'protease'\n\n    CONTROL_NAMES = [AUTOFLUORESCENCE_CONTROL, HIGH_FITC_CONTROL, HIGH_PE_CONTROL, PROTEASE_CONTROL]\n\n    DEFAULT_TEMPLATES = {\n        stability: 'protstab template V1',\n        protein_binding: 'binding template V1'\n    }\n\n    ########## DEFAULT PARAMS ##########\n\n    # Params that are applied equally to all operations. Can be overridden by\n    #   associating a list of key, value pairs to the `Plan`.\n    #\n    # @example my_plan.associate(\"options\", \"{\"od_ml_needed\": 2.0}\")\n    def default_plan_params\n        {\n            experiment_template:                DEFAULT_TEMPLATES[:stability],\n            events_to_record:                   30000,\n            default_to_sort:                    12E6.to_i,\n            facs_model:                         Cytometers::SonySH800S::CYTOMETER_NAME,\n            run_calibration_beads:              false,\n            library_resuspension_milliliters:   2.0\n        }\n    end\n\n  ########## MAIN ##########\n\n    def main\n\n        @plan_params = update_plan_params(\n            plan_params: default_plan_params,\n            opts: get_opts(operations)\n        )\n\n        # Takes _microliters and _milliliters keys and generates _vol keys for display purposes.\n        @plan_params = add_qty_display(@plan_params)\n\n        @plan = operations.first.plan\n\n        if debug\n            @plan.associate(:rounds_complete, 0)\n            inspect rounds_complete\n        end\n\n        @now_sorting = false\n        @tube_ct = 0\n        @beads = produce_beads if @plan_params[:run_calibration_beads]\n\n        operations.retrieve.make\n\n        set_test_conditions if debug\n\n        operations.each { |op| txfr_tube_labels(op, INPUT_YEAST, OUTPUT_YEAST) }\n\n        get_facs(@plan_params[:facs_model])\n\n        prepare_materials\n\n        go_to_facs_and_login\n\n        job = get_job\n\n        set_up_instrument(\n            experiment_name: \"Job_#{job.id}\",\n            template: @plan_params[:experiment_template],\n            events_to_record: @plan_params[:events_to_record],\n            target_events: target_events(\n                default_to_sort: @plan_params[:default_to_sort],\n                frac_positive: 0.1\n            ),\n            args: { left_gate: sort_gate_name }\n        )\n\n        all_samples = collect_samples\n\n        show_debug_table(samples: all_samples) if debug\n\n        run_all(samples: all_samples)\n\n        shutdown\n\n        @plan.associate(:rounds_complete, rounds_complete + 1)\n\n        if debug\n            inspect rounds_complete\n            operations.each do |op|\n                inspect op.output(OUTPUT_YEAST).item.associations\n            end\n        end\n\n        spin_down_samples\n\n        items_to_delete = operations.map { |op| op.input(INPUT_YEAST).item }\n        items_to_delete += operations.reject { |op| sort?(op) }.map { |op| op.output(OUTPUT_YEAST).item }\n        items_to_delete.each { |i| i.mark_as_deleted }\n\n        discard_input_samples\n\n        operations.store(interactive: false)\n\n        return {}\n\n    end\n\n    ########## SAMPLE CONTROL FLOW ##########\n\n    def run_all(samples:)\n        prev_item = nil\n\n        samples.each do |sample|\n            item = sample[:item]\n            sort = sample[:sort]\n            control = sample[:control]\n\n            tube_label = sample_tube_label(item)\n            resuspend_pellet(item) unless item.associations[:resuspended]\n\n            if @now_sorting\n                remove_tube_from_sorter(item: prev_item, collection_tube: COLLECTION_TUBE)\n                @now_sorting = false\n            end\n\n            remove_sample_tube(sample_tube: SAMPLE_TUBE) if @tube_ct \u003e 0\n            @tube_ct += 1 unless item.associations[:software_tube_id]\n            set_and_run_tube(item: item, tube_label: tube_label, tube_ct: @tube_ct, sort: sort)\n\n            if control\n                check_gates(\n                    control: control,\n                    experiment_template: @plan_params[:experiment_template]\n                )\n            end\n\n            if sort\n                sort_tube(\n                    item: item,\n                    tube_label: tube_label,\n                    default_to_sort: @plan_params[:default_to_sort],\n                    gate_name: sort_gate_name,\n                    debug: debug\n                )\n                @now_sorting = true\n            end\n\n            mark_as_data_collected(item)\n            prev_item = item\n        end\n\n        remove_tube_from_sorter(item: prev_item, collection_tube: COLLECTION_TUBE) if @now_sorting\n        remove_sample_tube(sample_tube: SAMPLE_TUBE)\n    end\n\n    ########## SHOW METHODS ##########\n\n    def prepare_materials\n\n        show do\n            title \"Gather dry materials\"\n\n            # Make this more specific for the Sony.\n            note \"Put these items in a small box.\"\n            check \"#{operations.length} #{SAMPLE_TUBE}.\"\n            warning \"You must use #{required_sample_tube}!\" if required_sample_tube\n\n            check \"A 1000 or 1200 ul pipettor.\"\n            check \"A box of blue pipet tips.\"\n        end\n\n        sorted_ops = operations.sort_by { |op| sample_tube_label(op, OUTPUT_YEAST) }.extend(OperationList)\n\n        show do\n            title \"Gather cold materials\"\n\n            note \"Pack #{operations.length} tubes containing cell pellets on ice in a bucket or small cooler.\"\n            table sorted_ops.start_table\n                .custom_column(heading: \"Tube label\", checkable: true) { |op| sample_tube_label(op, OUTPUT_YEAST) }\n                .end_table\n\n            check \"Pack a bottle of #{RESUSPENSION_BUFFER} in the cooler. You will need at least #{operations.length * 4} ml.\"\n        end\n\n        show do\n            title \"Prepare collection tubes\"\n\n            note \"Get #{libraries_to_sort.length} #{COLLECTION_TUBE}.\"\n            note \"Place the tubes in the ice bucket.\"\n        end\n\n        if @plan_params[:run_calibration_beads]\n            show do\n                title \"Prepare calibration beads\"\n\n                note \"Take one #{SAMPLE_TUBE} and label it \\\"#{CALIBRATION_BEADS_LABEL}\\\".\"\n                note \"Pipet #{qty_display(CALIBRATION_BEAD_VOLUME)} #{RESUSPENSION_BUFFER} into the tube.\"\n                note \"Get the #{CALIBRATION_BEADS} from the refrigerator.\"\n\n                BEAD_CAP_COLORS.each do |color|\n                    note \"Add \u003cb\u003etwo drops\u003c/b\u003e from the \u003cb\u003e#{color}\u003c/b\u003e-capped tube to the tube.\"\n                end\n\n                note \"After adding the beads, vortex the tube for 3 Mississippi.\"\n                note \"Add the prepared beads to the cooler.\"\n            end\n\n            mark_as_resuspended(@beads)\n        end\n\n    end\n\n    # TODO: Need to make this specific for Sony.\n    def resuspend_pellet(item)\n        tube_label = sample_tube_label(item)\n        resuspension_qty = @plan_params[:library_resuspension_qty]\n\n        show do\n            title \"Resuspend #{tube_label}\"\n\n            note \"Take a clean #{SAMPLE_TUBE} and label it as \\\"#{tube_label}.\\\"\"\n            note \"Remove the cap from the #{SAMPLE_TUBE} and place the tube in the ice bucket.\"\n\n            note \"Take the #{MICROFUGE_TUBE} labeled #{tube_label} from the ice bucket.\"\n\n            if resuspension_qty[:units] == MILLILITERS \u0026\u0026 resuspension_qty[:qty] \u003e 1.0\n                remainder = resuspension_qty.dup\n                remainder[:qty] -= 1.0\n\n                note \"Pipet 1.0 #{MILLILITERS} #{RESUSPENSION_BUFFER} into the tube.\"\n                note \"Gently pipet the #{RESUSPENSION_BUFFER} up and down until \" \\\n                        \"the pellet is fully resuspended.\"\n                note \"Pipet the resuspended yeast from the #{MICROFUGE_TUBE} to the #{SAMPLE_TUBE}.\"\n                note \"Pipet an additional #{qty_display(remainder)}  \" \\\n                        \"#{RESUSPENSION_BUFFER} into the  #{SAMPLE_TUBE}.\"\n            else\n                note \"Pipet #{qty_display(resuspension_qty)} #{RESUSPENSION_BUFFER} into the tube.\"\n                note \"Gently pipet the #{RESUSPENSION_BUFFER} up and down until \" \\\n                        \"the pellet is fully resuspended.\"\n                note \"Pipet the resuspended yeast from the #{MICROFUGE_TUBE} to the #{SAMPLE_TUBE}.\"\n            end\n\n        end\n\n        mark_as_resuspended(item)\n    end\n\n    def spin_down_samples\n        show do\n            title \"Go back to the lab\"\n            note \"Pack up your things and go back to the lab.\"\n            note \"Keep the #{COLLECTION_TUBE}s on ice as you travel.\"\n        end\n\n        show do\n            title \"Centrifuge samples\"\n\n            note \"Make sure the #{COLLECTION_TUBE}s are balanced by adding #{RESUSPENSION_BUFFER}.\"\n            note \"Spin for 5 minutes at 4696 RCF (x g) in a swinging bucket centrifuge.\"\n            note \"Using the aspirator with a sterile tip, remove all but the last 100 µl of buffer.\"\n            note \"You can discard everything except these collecton tubes.\"\n            warning \"Go immediately to the next protocol.\"\n        end\n    end\n\n    def check_gates(control:, experiment_template:)\n        case control\n        when AUTOFLUORESCENCE_CONTROL\n            # if experiment_template == DEFAULT_TEMPLATES[:protein_binding]\n            #     show do\n            #         title 'Adjust the All Events gate'\n\n            #         note \"In the All Events (BSC-A vs. FSC-A) plot, move the \" \\\n            #                 \"ellipse so that it just includes all of the events in \" \\\n            #                 \"lower-left end of the major mass.\"\n            #         # image path_to('all_events')\n            #     end\n            # end\n\n            show do\n                title 'Adjust the lower FITC gate limit'\n\n                note \"In the FITC histogram, adjust the lower gate limit so that the percentage is \" \\\n                        \"between 0.1 and 0.5.\"\n                image path_to('fitc_autofluorescence')\n            end\n\n            if experiment_template == DEFAULT_TEMPLATES[:protein_binding]\n                show do\n                    title 'Adjust the lower PE gate limit'\n\n                    note \"In plot D, move the polygon up or down so that the \" \\\n                            \"percentage is between 0.01 and 0.05.\" \\\n                    # image path_to('all_events')\n                end\n            end\n\n        when HIGH_FITC_CONTROL\n            show do\n                title 'Verify / adjust the upper FITC gate limit'\n\n                note \"In the FITC histogram, verify that the upper gate includes the entire \" \\\n                        \"right-hand tail of the distribution. Adjust if needed.\"\n                # image path_to('fitc_autofluorescence')\n            end\n        end\n    end\n\n    def discard_input_samples\n        show do\n            title \"Discard Input Samples\"\n\n            note \"Discard all the #{MICROFUGE_TUBE}s and #{SAMPLE_TUBE}s.\"\n            warning \"Keep the #{COLLECTION_TUBE}s that you sorted into in the ice bucket.\"\n        end\n    end\n\n    ########## LABELS, GETTERS, AND SIMPLE CALCULATIONS ##########\n\n    def collect_samples\n        all_samples = []\n\n        all_samples \u003c\u003c { item: @beads } if @plan_params[:run_calibration_beads]\n\n        CONTROL_NAMES.each do |name|\n            controls(name).each do |item|\n                all_samples \u003c\u003c { item: item, control: name }\n            end\n        end\n\n        other_samples.each do |item|\n            all_samples \u003c\u003c { item: item }\n        end\n\n        libraries_to_sort.each do |item|\n            all_samples \u003c\u003c { item: item, sort: true }\n        end\n\n        all_samples\n    end\n\n    def controls(name)\n        ops = operations.select { |op| op.input('Control?').val =~ /#{name}/i }\n        return [] if ops.blank?\n        ops.map { |op| op.output(OUTPUT_YEAST).item }\n    end\n\n    def libraries_to_sort\n        ops = operations.select { |op| sort?(op) }\n        items = ops.map { |op| op.output(OUTPUT_YEAST).item }\n        items.partition { |item| item.associations[:resuspended] }.reduce(:+)\n    end\n\n    def sort?(op)\n        op.input('Sort?').val =~ /yes/i\n    end\n\n    def other_samples\n        ops = operations.select { |op| op.input('Control?').val =~ /no/i \u0026\u0026 op.input('Sort?').val =~ /no/i }\n        return [] if ops.blank?\n        ops.map { |op| op.output(OUTPUT_YEAST).item }\n    end\n\n    def produce_beads\n        beads = produce(new_sample(CALIBRATION_BEADS, of: \"Beads\", as: \"Diluted beads\"))\n        beads.associate(:sample_tube_label, CALIBRATION_BEADS_LABEL)\n    end\n\n    def mark_as_resuspended(item)\n        item.associate(:resuspended, true)\n    end\n\n    def mark_as_data_collected(item)\n        item.associate(:data_collected, true)\n    end\n\n    def rounds_complete\n        @plan.associations[:rounds_complete] || 0\n    end\n\n    def get_job\n        operation_ids = operations.map { |op| op.id }\n        ja_ids = JobAssociation.where(operation_id: operation_ids).map { |ja| ja.job_id }.uniq\n        possible_jobs = Job.find(ja_ids).select { |j| j.active? }\n\n        if possible_jobs.length \u003e 1\n            raise \"Cannot resolve the current Job\"\n        else\n            possible_jobs.first\n        end\n    end\n\n    def get_facs(facs_model)\n        case facs_model\n        when Cytometers::BDAriaIII::CYTOMETER_NAME\n            self.extend Cytometers::BDAriaIII\n        when Cytometers::SonySH800S::CYTOMETER_NAME\n            self.extend Cytometers::SonySH800S\n        else\n            raise Cytometers::CytometerInputError.new, \"Unrecognized FACS Model: #{facs_model}\"\n        end\n    end\n\n    def sort_gate_name\n        # TODO: Need a class or module that handles experiment templates\n        case @plan_params[:experiment_template]\n        when DEFAULT_TEMPLATES[:protein_binding]\n            'PE positive'\n        when DEFAULT_TEMPLATES[:stability]\n            'FITC positive'\n        end\n    end\n\n    ########## DEBUG METHODS ##########\n\n    def set_test_conditions\n        set_test_labels(operations.map { |op| op.input(INPUT_YEAST).item })\n    end\n\n    def show_debug_table(samples:)\n        debug_table = [[\"Item\", \"Label\", \"Control?\", \"Sort?\"]]\n        samples.each do |s|\n            debug_table \u003c\u003c [s[:item].to_s, sample_tube_label(s[:item]), s[:control], s[:sort]]\n        end\n        show do\n            table debug_table\n        end\n    end\n\nend","precondition":"def precondition(_op)\n  true\nend","cost_model":"def cost(_op)\n  { labor: 16.94, materials: 9.83 }\nend","documentation":"Documentation here. Start with a paragraph, not a heading or title, as in most views, the title will be supplied by the view.","test":"","timing":null}},{"library":{"name":"ChallengeAndLabelDebug","category":"Yeast Display","code_source":"needs \"Standard Libs/Debug\"\n\nmodule ChallengeAndLabelDebug\n\n    require 'json'\n\n    include Debug\n\n    INPUT_YEAST = \"Yeast Culture\"\n    PROTEASE = \"Protease\"\n\n    OPTIONS = {\n\n    }\n\n    DEBUG_CONCENTRATIONS = {\n        'Chymotrypsin' =\u003e { stock: 20894 },\n        'Trypsin' =\u003e { stock: 32881 }\n    }\n    # Helps create a realistic set of inputs for tests\n    #\n    # @note Overrides inputs for randomly-generated items\n    def override_input_operations\n\n        consolidate_yeast_inputs\n        consolidate_protease_inputs\n\n        associate_plan_options(OPTIONS)\n    end\n\n    def associate_plan_options(opts)\n        plan = operations.first.plan\n        plan.associate(:options, opts.to_json)\n    end\n\n    def consolidate_yeast_inputs\n        grp = operations.group_by { |op| [op.input(INPUT_YEAST).sample, op.input(PROTEASE).sample] }\n        consolidate_inputs(grp, INPUT_YEAST)\n    end\n\n    def consolidate_protease_inputs\n        grp = operations.group_by { |op| op.input(PROTEASE).sample }\n        consolidate_inputs(grp, PROTEASE)\n        items = operations.map { |op| op.input(PROTEASE).item }.uniq\n        items.each { |i| i.associate(:units_per_milliliter, DEBUG_CONCENTRATIONS[i.sample.name][:stock]) }\n    end\n\n    def consolidate_inputs(grouped_ops, input_name)\n        grouped_ops.values.each do |ops|\n            child_item_id = ops.shift.input(input_name).child_item_id\n            ops.each do |op|\n                op.input(input_name).update_attributes(child_item_id: child_item_id)\n            end\n        end\n    end\n\nend"}},{"library":{"name":"ChallengeAndLabelHelper","category":"Yeast Display","code_source":"needs \"Yeast Display/YeastDisplayHelper\"\nneeds \"Yeast Display/ChallengeAndLabelDebug\"\n\nmodule ChallengeAndLabelHelper\n\n    include YeastDisplayHelper, ChallengeAndLabelDebug\n\n    OUTPUT_YEAST = 'Labeled Yeast Library'\n\n    PROTEASE_CONCENTRATION = 'Protease Concentration'\n    PROTEASE = 'Protease'\n    ANTIBODY = 'Antibody'\n    PRETREATMENT = 'Pretreatment'\n\n    ASSAY_BUFFER = 'Assay Buffer'\n    INCUBATION_BUFFER = 'Incubation buffer'\n    QUENCH_BUFFER = 'Quench buffer'\n    BINDING_BUFFER = 'Binding buffer'\n    PRETREATMENT_BUFFER = 'Pretreatment buffer'\n\n    ALL_BUFFERS = [ASSAY_BUFFER, INCUBATION_BUFFER, QUENCH_BUFFER, BINDING_BUFFER]\n\n    BUFFER_CONTAINERS = {\n        INCUBATION_BUFFER =\u003e '250 ml bottle',\n        QUENCH_BUFFER =\u003e '100 ml bottle',\n        BINDING_BUFFER =\u003e '100 ml bottle'\n    }\n\n    DEFAULT_CONCENTRATIONS = {\n        'Chymotrypsin' =\u003e { stock: 36191 },\n        'Trypsin' =\u003e { stock: 32881 },\n        'IL-23R' =\u003e { stock: 17.2 }\n    }\n\n    # Tells the tech to get some equipment that is needed.\n    #\n    def prepare_equipment\n        show do\n            title 'Gather materials'\n            check 'Fill 2 buckets with ice.'\n            check \"Get the 24-well aluminum block out of the 4 #{DEGREES_C}\" \\\n                'refrigerator and place it in one of the ice buckets.'\n            check \"Set the refigerated centrifuge to 4 #{DEGREES_C}.\"\n        end\n    end\n\n    # Decide whether/which proteases are needed; retrieve them and the associated buffers.\n    #\n    def gather_buffers_and_proteases\n        # Decide if the technician needs to retrieve any protease stocks.\n        retrieve_protease = @plan_params[:incubate_with_protease] \u0026\u0026 protease_needed\n\n        operations.retrieve(only: ALL_BUFFERS)\n        operations.retrieve(only: PROTEASE) if retrieve_protease\n\n        show do\n            title 'Prepare materials'\n            note 'Place the PBSF and TBSF (if gathered) on ice.'\n            note 'Leave the PBS and TBS (if gathered) at room temperature.'\n            note \"Let the stocks thaw at room temperature.\" if retrieve_protease\n        end\n    end\n\n    # Put all the materials away.\n    #\n    def clean_up\n        show do\n           title 'Store pellets on ice'\n           note temp_instructions(ON_ICE)\n\n           note 'Keep the labeled cell pellets, in the 24-well aluminum block, on ice until you are ready for FACS.'\n        end\n\n        buffers = operations.map { |op| op.inputs.select { |i| ALL_BUFFERS.include?(i.name) } }.flatten\n        buffers.map! { |b| b.child_item }.uniq!\n\n        release(buffers, interactive: true)\n\n        show do\n           title 'Clean up'\n\n           check 'Any items that remain on the bench (other than the labeled cell pellets) can be discarded.'\n           check \"Set the refigerated centrifuge back to 25 #{DEGREES_C}.\"\n        end\n    end\n\n    ########## LABELS, GETTERS, AND SIMPLE CALCULATIONS ##########\n\n    def binding_buffer(op)\n        # @buffer_lookup[op.input(ANTIBODY).sample][BINDING_BUFFER]\n        op.input(BINDING_BUFFER).item\n    end\n\n    def incubation_buffer(op)\n        # @buffer_lookup[op.input(PROTEASE).sample][INCUBATION_BUFFER]\n        op.input(INCUBATION_BUFFER).item\n    end\n\n    def quench_buffer(op)\n        # @buffer_lookup[op.input(PROTEASE).sample][QUENCH_BUFFER]\n        op.input(QUENCH_BUFFER).item\n    end\n\n    def protease_samples\n        # @buffer_lookup.keys.select { |s| s.sample_type.name == PROTEASE }\n        operations.map { |op| op.input(PROTEASE).sample }.uniq\n    end\n\n    def protease_needed\n        operations.select { |op| op.temporary[:treatment_qty] \u003e 0 }.present?\n    end\n\n    # Sort operations based on protease and concentration.\n    #\n    def sort_operations\n        operations.sort! { |a, b| sort_list(b, a) \u003c=\u003e sort_list(a, b) }\n    end\n\n    # Provide an array of protease name and concentration to sort on.\n    #\n    def sort_list(x, y)\n        [protease_name(x), protease_conc(y)]\n    end\n\n    def protease_name(op)\n        op.input(PROTEASE).sample.name\n    end\n\n    def protease_conc(op)\n        conc = op.input(PROTEASE_CONCENTRATION).val\n\n        if conc.negative?\n            conc = op.input(PROTEASE).item.get(:expected_treatment_concentration)\n            conc ||= 10000\n            op.input(PROTEASE_CONCENTRATION).update_attributes(val: conc)\n            inspect \"Op #{op.id} has been reassigned concentration #{conc}\"\n        end\n\n        conc\n    end\n\n    def abbreviated_concentration(op)\n        \"#{protease_name(op)[0]}#{protease_conc(op).round}\"\n    end\n\n    def ops_by_inc_bfr\n        operations.group_by { |op| incubation_buffer(op)[:label] }\n    end\n\n    def ops_by_binding_bfr\n        operations.group_by { |op| binding_buffer(op)[:label] }\n    end\n\n    def buffer_container(buffer:, handle:)\n        if buffer.name == \"PBSF\" || buffer.name == \"TBSF\"\n            container_name = BUFFER_CONTAINERS[BINDING_BUFFER]\n        else\n            container_name = BUFFER_CONTAINERS[handle]\n        end\n\n        attributes = { name: container_name, sample_type_id: buffer.sample_type.id }\n        container = ObjectType.where(attributes).first\n        raise \"Container not found\" unless container\n        container\n    end\n\nend"}},{"library":{"name":"FastMixAndQuench","category":"Yeast Display","code_source":"needs \"Yeast Display/YeastDisplayHelper\"\n\nmodule FastMixAndQuench\n\n    include YeastDisplayHelper\n    # Mix the treatment aliquots with the cell suspensions and incubate for the specified time.\n    #\n    def arrange_tubes(args)\n        args = arrange_defaults.merge(args)\n\n        show do\n            title \"Set up #{args[:treatment_name]} and #{args[:sample_name]} aliquots\"\n            note temp_instructions(args[:temp])\n\n            note 'Arrange the tubes in a tube holder as shown'\n\n            if args[:grouped_ops].keys.length \u003e 1\n                note \"Leave space between the groups of tubes\"\n            end\n\n            h1 = args[:treatment_name].titlecase\n            h2 = args[:sample_name].titlecase\n\n            args[:grouped_ops].each do |bfr, ops|\n                note \"\u003cbr\u003e\"\n                table ops.start_table\n                    .custom_column(heading: h1) { |op| treatment_tube_label(op, args[:output_handle]) }\n                    .custom_column(heading: h2, checkable: true) { |op| sample_tube_label(op, args[:output_handle]) }\n                    .end_table\n            end\n        end\n    end\n\n    def mix_samples(args)\n        args = mix_defaults.merge(args)\n        show do\n            title \"Mix #{args[:treatment_name]} and #{args[:sample_name]} aliquots\"\n            warning 'Before you perform the following steps, set the timer to countdown for 5 minutes.'\n            warning \"Start the timer as you add the first set of #{args[:treatment_name]} aliquots to the #{args[:sample_name]} aliquots.\"\n\n            note \"Use a multichannel pipettor to transfer #{qty_display(args[:treatment_vol])} of the #{args[:treatment_name]} aliquots into the #{args[:sample_name]} aliquots.\"\n            note \"You will only be able to pipet one of the buffers at a time.\"\n            note \"Add the buffers in this order: #{args[:grouped_ops].keys.join(', ')}.\"\n\n            note \"After you make the transfer, pipet up and down three times with the multichannel pipettor to mix the samples.\"\n        end\n    end\n\n    def incubate(args)\n        args = incubate_defaults.merge(args)\n\n        time_left = args[:incubation_time].dup\n\n        show do\n            title \"Incubate with #{args[:treatment_name]} for #{qty_display(args[:incubation_time])}\"\n\n            note \"\u003cb\u003eSTEP 1:\u003c/b\u003e Incubate\"\n            note \"Incubate #{qty_display(args[:incubation_time])} at room temperature.\"\n\n            while time_left[:qty] \u003e args[:vortex_interval][:qty]\n                time_left[:qty] -= args[:vortex_interval][:qty]\n                check \"Vortex tubes for 5 seconds when #{qty_display(time_left)} remains.\"\n            end\n\n            if args[:quench_protease]\n                check 'After the last vortex, open the tubes and get ready to add the quench buffer into the multichannel pipettor.'\n\n                note \"\u003cb\u003eSTEP 2:\u003c/b\u003e Quench and remove buffer\"\n                note \"When the timer is complete, add #{qty_display(args[:quench_vol])} chilled quench buffer to each tube according to the table.\"\n\n                args[:grouped_ops].each do |bfr, ops|\n                    note \"\"\n                    table wash_buffer_table(ops, output_handle: args[:output_handle], buffer_handle: args[:buffer_handle])\n                end\n\n                note VORTEX_CELLS\n            end\n\n            check SPIN_CELLS\n            check REMOVE_BUFFER\n        end\n    end\n\n    def common_defaults\n        {\n            treatment_name: 'protease',\n            sample_name: 'yeast culture'\n        }\n    end\n\n    def arrange_defaults\n        common_defaults #.merge({})\n    end\n\n    def mix_defaults\n        common_defaults #.merge({})\n    end\n\n    def incubate_defaults\n        common_defaults #.merge({})\n    end\nend"}},{"library":{"name":"LabelWithAntibody","category":"Yeast Display","code_source":"needs \"Yeast Display/YeastDisplayHelper\"\n\nmodule LabelWithAntibody\n    \n    include YeastDisplayHelper\n    \n    # Add diluted antibody to the samples and incubate for the specified time.\n    # \n    def incubate_with_antibody(args)\n        show do\n            title 'Add diluted antibody to cell pellets'\n            note temp_instructions(ON_ICE)\n                \n            note \"Add #{qty_display(args[:antibody_qty])} diluted antibody to the each cell pellet.\"\n            note VORTEX_CELLS\n            note 'Place the tubes in a small ice-filled box on the nutating mixer.'\n            note 'Set the timer and incubate the tubes for 10 minutes.'\n        end\n        \n        show do\n            title 'Spin down antibody-labeled cells and remove the supernatant'\n            note temp_instructions(ON_ICE)\n            \n            note 'After incubating the tubes for 10 minutes.'\n            check SPIN_CELLS\n            check REMOVE_BUFFER\n        end\n    end\n    \nend"}},{"library":{"name":"NormalizeCultureDensity","category":"Yeast Display","code_source":"needs \"Yeast Display/YeastDisplayHelper\"\n\nmodule NormalizeCultureDensity\n\n    include YeastDisplayHelper\n\n    TUBE_50_ML_CONICAL = \"50 ml conical tube\"\n    TUBE_15_ML_CONICAL = \"15 ml conical tube\"\n    TUBE_MICROFUGE = \"1.5 ml microfuge tube\"\n\n    # Check culture densities, then aliquot and resuspend specified number of cells\n    #\n    # @param args [Hash]\n    # @option args [String] :input_handle  the `Name` of the culture `Input` of the `Operation`\n    # @option args [String] :output_handle  the `Name` of the resuspended culture `Output` of the `Operation`\n    # @option args [Numeric] :od_ml_needed  the number of cells in each aliquot, as OD*ml\n    # @option args [Hash] :temp (YeastDisplayHelper::ROOM_TEMP)  info about the temperature,\n    #   usually passed as a constant from `YeastDisplayHelper`\n    # @option args [Hash] :resuspend_qty  the volume to resuspend the yeast in\n    # @option args [Boolean] :debug (false)  set realistic ODs for testing\n    # @return [OperationList] a subset of the `Job Operations` with unique input culture\n    def normalize_culture_density(args)\n\n        args = normalize_defaults.update(args)\n\n        input_handle = args[:input_handle]\n\n        normalize_reqd_args.each do |ra|\n            unless args[ra]\n                raise NormalizeCultureDensityInputError.new(\n                    \"Required argument :#{ra} not found.\"\n                )\n            end\n        end\n\n        unique_culture_operations = operations.uniq { |op| op.input(input_handle).item }.extend(OperationList)\n\n        measure_culture_ods(unique_culture_operations)\n\n        unique_culture_operations.each { |op| op.input(input_handle).item.associate(:od, op.temporary[:od]) }\n\n        set_test_ods if args[:debug]\n\n        max_volume = unique_culture_operations.map { |op|library_culture_volume(op, args) }.max\n\n        ops_by_culture_item = operations.group_by { |op| op.input(input_handle).item }\n\n        show do\n            title 'Aliquot library cultures'\n            note temp_instructions(args[:temp])\n\n            note \"You will need #{operations.length} #{destination_tube(max_volume)}s.\"\n\n            note LABEL_TUBES_FROM_TABLE\n\n            ops_by_culture_item.each do |culture_item, ops|\n                note \"\u003cb\u003e#{input_handle} Item ID #{culture_item.id}\u003c/b\u003e\"\n                table ops.extend(OperationList).start_table\n                    .custom_column(heading: \"Label\") { |op| sample_tube_label(op, args[:output_handle]) }\n                    .custom_column(heading: \"Culture (#{MICROLITERS})\", checkable: true) { |op| library_culture_volume(op, args) }\n                    .end_table\n                note \" \"\n            end\n\n            warning 'Balance the tubes with sterile PBS' unless destination_tube(max_volume) == TUBE_MICROFUGE\n            note 'Spin 1 min at 5000 x g in a \u003cb\u003eroom temperature\u003c/b\u003e centrifuge, and aspirate off all the media.'\n        end\n\n        resuspend_units = args[:resuspend_qty][:units]\n        resuspend_vol = args[:resuspend_qty][:qty].to_s\n\n        ops_by_buffer = operations.group_by { |op| resuspension_buffer(op, args[:buffer_handle]) }\n\n        show do\n            title 'Resuspend yeast library cultures'\n            note temp_instructions(args[:temp])\n\n            ops_by_buffer.each do |bfr, ops|\n                note \"\u003cb\u003e#{bfr}\u003c/b\u003e\"\n                table ops.extend(OperationList).start_table\n                    .custom_column(heading: \"Label\") { |op| sample_tube_label(op, args[:output_handle]) }\n                    .custom_column(heading: \"Vol (#{resuspend_units})\", checkable: true) { |op| resuspend_vol }\n                    .end_table\n                note \" \"\n            end\n\n            note VORTEX_CELLS\n        end\n\n        unique_culture_operations\n    end\n\n    def resuspension_buffer(op, handle)\n        input = op.input(handle)\n\n        if op.temporary[:modified_buffer].present?\n            op.temporary[:modified_buffer]\n        elsif input.value.present?\n            input.value\n        elsif input.sample.present?\n            input.sample.name\n        else\n            'not found'\n        end\n    end\n\n    def normalize_reqd_args\n        [:input_handle, :output_handle, :od_ml_needed, :resuspend_qty, :buffer_handle]\n    end\n\n    def normalize_defaults\n        {\n            temp: ROOM_TEMP,\n            debug: false\n        }\n    end\n\n    # Calculate the volume of culture to take based on the OD and the OD*ml needed\n    #\n    # @param op [Operation]\n    # @param [Hash] args\n    # @option args [String] :input_handle  the `Name` of the culture `Input` of the `Operation`\n    # @option args [Numeric] :od_ml_needed  the number of cells in each aliquot, as OD*ml\n    # @return [Numeric] the volume of culture to take, in `MICROLITERS`\n    def library_culture_volume(op, args)\n        (1000 * args[:od_ml_needed] / (op.input(args[:input_handle]).item.associations[:od] * 10)).round\n    end\n\n    def destination_tube(volume)\n        if volume \u003e 15000\n            return TUBE_50_ML_CONICAL\n        elsif volume \u003e 1500\n            return TUBE_15_ML_CONICAL\n        else\n            return TUBE_MICROFUGE\n        end\n    end\n\n    class NormalizeCultureDensityInputError \u003c StandardError; end\n\nend"}},{"library":{"name":"PrepareTreatmentDilutions","category":"Yeast Display","code_source":"needs \"Yeast Display/YeastDisplayHelper\"\n\nmodule PrepareTreatmentDilutions\n    \n    include YeastDisplayHelper\n    \n    # Dilute treatments to the appropriate concentrations for the assay.\n    #\n    def prepare_treatment_dilutions(args)\n        ops_by_treatment_sample = operations.group_by { |op| op.input(args[:treatment_handle]).sample }\n        \n        ops_by_treatment_sample.each do |treatment_sample, ops|\n            no_prot_ops, some_prot_ops = ops.partition { |op| op.temporary[:treatment_qty].zero? }\n            \n            if no_prot_ops.present?\n                # TODO: this doesn't work if the no treatment controls have different buffers\n                # But may not be a problem\n                inc_bfr = no_prot_ops.first.input(args[:buffer_handle]).sample.name\n             \n                tube_labels = no_prot_ops.map { |op| treatment_tube_label(op, args[:output_handle]) }.join(\"\\\", \\\"\")\n                buffer_qty = qty_display(args[:treatment_working_qty])\n                \n                show do\n                    title \"Set up no treatment buffer aliquots\"\n                    note temp_instructions(args[:temp])\n                    \n                    note \"You will need #{no_prot_ops.length} 1.5 ml microfuge tubes.\"\n                    check \"Label the tubes \\\"#{tube_labels}\\\".\"\n                    check \"Add #{buffer_qty} #{inc_bfr} to each tube.\"\n                end\n            end\n            \n            if some_prot_ops.present?\n                show do\n                    title \"Set up #{treatment_sample.name} treatment dilutions\"\n                    note temp_instructions(args[:temp])\n                    \n                    note \"You will need #{some_prot_ops.length} 1.5 ml microfuge tubes.\"\n                    \n                    units = args[:treatment_working_qty][:units]\n                    \n                    note LABEL_TUBES_FROM_TABLE\n                    table some_prot_ops.extend(OperationList).start_table\n                        .custom_column(heading: \"Tube label\") { |op| treatment_tube_label(op, args[:output_handle]) }\n                        .input_item(args[:treatment_handle])\n                        .custom_column(heading: \"Treatment (#{units})\", checkable: true) { |op| op.temporary[:treatment_qty].round(1) }\n                        .custom_column(heading: \"Buffer\") { |op| op.input(args[:buffer_handle]).sample.name }\n                        .custom_column(heading: \"Buffer (#{units})\", checkable: true) { |op| op.temporary[:buffer_qty].round }\n                        .end_table\n                end\n            end\n        end\n    end\n    \nend"}},{"library":{"name":"WashYeast","category":"Yeast Display","code_source":"needs \"Yeast Display/YeastDisplayHelper\"\n\nmodule WashYeast\n    \n    include YeastDisplayHelper\n    \n    # A general method for washing yeast cultures or suspension.\n    #\n    def wash_yeast(args)\n        args = wash_defaults.merge(args)\n        \n        unless args[:grouped_ops].present? \u0026\u0026 args[:grouped_ops].respond_to?(:keys)\n            raise WashYeastInputError.new('Operations missing or incorrectly formatted.')\n        end\n        \n        show do\n            title \"Begin washes\"\n            \n            note \"Now you will wash the samples #{args[:n_washes]} times.\"\n            note \"Be sure to check the boxes as you go so you don't lose track!\"\n        end\n        \n        args[:n_washes].times do |i|\n            show do\n                title \"Wash #{i + 1} of #{args[:n_washes]}\"\n                note temp_instructions(args[:temp])\n                \n                note ADD_WASH_BUFFER % args[:wash_vol]\n                note VORTEX_CELLS\n                \n                args[:grouped_ops].each do |bfr, ops|\n                    note \"\"\n                    table wash_buffer_table(ops, output_handle: args[:output_handle], buffer_handle: args[:buffer_handle])\n                end\n                \n                check SPIN_CELLS\n                check REMOVE_BUFFER\n            end\n        end\n    end\n    \n    def wash_defaults\n        {\n            n_washes: 2,\n            temp: ROOM_TEMP,\n            wash_vol: { qty: 1.0, units: MILLILITERS }\n        }\n    end\nend\n\n\n# Error class for bad parameters.\nclass WashYeastInputError \u003c StandardError\n    \nend"}},{"library":{"name":"YeastDisplayHelper","category":"Yeast Display","code_source":"needs 'Standard Libs/CommonInputOutputNames'\nneeds \"Standard Libs/Units\"\nneeds \"Standard Libs/TemporaryTubeLabels\"\nneeds \"Yeast Display/YeastDisplayShows\"\n\nmodule YeastDisplayHelper\n\n    include CommonInputOutputNames, Units, TemporaryTubeLabels\n    include YeastDisplayShows\n\n    ADD_WASH_BUFFER = \"Add %{qty} %{units} of chilled quench buffer to each tube according to the table.\"\n    VORTEX_CELLS = 'After adding buffer, vortex each tube for 3 pulses.'\n    SPIN_CELLS = 'Spin 1 min at 5000 x g in a 4 °C microcentrifuge.'\n    REMOVE_BUFFER = 'Aspirate off the buffer without disturbing the cell pellet.'\n    LABEL_TUBES_FROM_TABLE = 'Label the tubes and add the reagent volumes as indicated'\n\n    ROOM_TEMP = { style: 'bg-color: lightorange', temp: 'AT ROOM TEMPERATURE' }\n    ON_ICE = { style: 'bg-color: powderblue', temp: 'ON ICE' }\n\n    INCUBATOR = \"30 °C shaker incubator\"\n\n    def prepare_media_and_dilute(container, container_group, protocol=:yeast_display)\n        container_group.extend(OperationList)\n\n        language = container_specific_language(protocol, container)\n\n        if container == \"Labeled Yeast Library Suspension\"\n            get_media(container_group)\n        else\n            prepare_media(container_group, language)\n        end\n\n        innoculate_flasks(container_group, language)\n    end\n\n    def group_ops_by_container\n        ops_by_container = operations.group_by { |op| container_name(op) }\n        ops_by_container.each_value { |ops_group| ops_group.extend(OperationList) }\n        ops_by_container\n    end\n\n    def container_name(op, handle=INPUT_YEAST)\n        op.input(handle).object_type.name\n    end\n\n    def media_volume(op, handle=INPUT_YEAST)\n        op.input(handle).item.associations[:media_vol]\n    end\n\n    def transfer_volume(op, handle=INPUT_YEAST)\n        op.input(handle).item.associations[:txfr_vol]\n    end\n\n    def temp_instructions(substitutions)\n        \"\u003cspan style=\\\"%{style}\\\"\u003eKEEP TUBES AND BUFFERS \u003cb\u003e%{temp}\u003c/b\u003e\u003c/span\u003e\" % substitutions\n    end\n\n    def materials_prep_temp(substitutions)\n        \"\u003cspan style=\\\"%{style}\\\"\u003eThese materials should be placed \u003cb\u003e%{temp}\u003c/b\u003e\u003c/span\u003e\" % substitutions\n    end\n\n    def set_unique_items(handle)\n        donor = operations.first.input(handle)\n        operations.each { |op| op.input(handle).set( { item: donor.item }) }\n    end\n\n    def container_specific_language(protocol, container)\n        case protocol\n\n        when :yeast_display\n            yeast_display_containers(container)\n\n        when :library_transformation\n            library_transformation_containers(container)\n\n        else\n            raise \"Unrecognized Protocol: #{protocol}.\"\n\n        end\n    end\n\n    def yeast_display_containers(container)\n        case container\n\n        when \"Yeast Library Glycerol Stock\"\n            {\n                flask_type: '250 ml baffled flask',\n                media_volume: '50 ml',\n                passage_amount: 'Pipette the entire glycerol stock of each input %{input_type} into the corresponding flask.'\n            }\n\n        when \"Labeled Yeast Library Suspension\"\n            {\n                flask_type: '15 ml culture tube',\n                media_volume: '5 ml',\n                passage_amount: 'Using a new 5 ml serological pipette for each sample, pipette %{media_volume} of media into each collection tube, pipette up and down a few times, then transfer to the corresponding culture tube.'\n            }\n\n        when \"Yeast Library Liquid Culture\", \"Yeast 5ml culture\", \"Yeast 50ml culture\"\n            {\n                flask_type: '250 ml baffled flask',\n                media_volume: '50 ml',\n                passage_amount: 'Pipette 1 ml of each input %{input_type} into the corresponding flask.'\n            }\n\n        when \"Yeast Plate\", \"Divided Yeast Plate\"\n            {\n                flask_type: '15 ml culture tube',\n                media_volume: '5 ml',\n                passage_amount: 'Pick 1 colony of each input %{input_type} into the corresponding flask.'\n            }\n\n        else\n            raise \"Unrecognized Container for Item in #{container}\"\n\n        end\n    end\n\n    def library_transformation_containers(container)\n        case container\n\n        when \"Yeast Plate\", \"Divided Yeast Plate\"\n            {\n                flask_type: '250 ml baffled flask',\n                media_volume: '50 ml',\n                passage_amount: 'Pick 1 colony of each input %{input_type} into the corresponding flask.'\n            }\n\n        when 'Yeast 50ml culture'\n            {\n                flask_type: '500 mL baffled flask',\n                media_volume: 'the indicated amount',\n                passage_amount: 'Pipette the indicated volume of each input %{input_type} into the corresponding flask.'\n            }\n\n        when '8 ml High Efficiency Transformation'\n            {\n                flask_type: '500 ml baffled flask',\n                media_volume: '92 ml',\n                passage_amount: 'Pipette the entire 8 ml of each input %{input_type} into the corresponding flask.'\n            }\n\n        else\n            raise \"Unrecognized Container for Item in #{container}\"\n\n        end\n    end\n\n    def mark_cultures_for_discard(culture_items)\n        culture_items.each { |item| item.move_to('Culture discard area') }\n\n        ids = culture_items.map { |item| item.to_s }\n        discard_date = (Date.today + 2).strftime(\"%-m/%-d/%y\")\n\n        show do\n            title \"Label cultures with discard date\"\n\n            note \"Label each of the cultures #{ids.to_sentence} with \\\"DISCARD ON #{discard_date}\\\"\"\n        end\n    end\n\n    def return_to_incubator\n        operations.each { |op| op.output(OUTPUT_YEAST).item.update_attributes(location: INCUBATOR) }\n    end\n\n    # Generates table for adding quench buffer to samples.\n    #\n    # @param ops [OperationList] usually a subset of the operations\n    # def quench_buffer_table(ops, output_handle)\n    #     ops.start_table\n    #         .custom_column(heading: \"Yeast library\") { |op| library_tube_label(op, output_handle) }\n    #         .custom_column(heading: \"Buffer\") { |op| quench_buffer(op)[:label] }\n    #         .end_table\n    # end\n\n    # Generates a table for adding wash buffer to the samples.\n    #\n    def wash_buffer_table(ops, args)\n        ops.start_table\n            .custom_column(heading: \"Sample\") { |op| sample_tube_label(op, args[:output_handle]) }\n            .custom_column(heading: \"Wash Buffer\") { |op| op.input(args[:buffer_handle]).sample.name }\n            .end_table\n    end\n\n    # Retrieve the antibody and dilute it to the appropriate concentration.\n    #\n    def prepare_reagent(args)\n        reagent_name = args[:reagent_name]\n        reagent_handle = args[:reagent_handle]\n        buffer_handle = args[:buffer_handle]\n        stock_per_rxn = args[:stock_per_rxn]\n        buffer_per_rxn = args[:buffer_per_rxn]\n        temperature = args[:temp] || ON_ICE\n\n        set_unique_items(reagent_handle) if args[:debug]\n\n        operations.retrieve(only: reagent_handle)\n\n        operations.each do |op|\n            op.temporary[:modified_buffer] = reagent_label(op, reagent_handle, buffer_handle)\n        end\n\n        ops_by_combo = operations.group_by { |op| op.temporary[:modified_buffer] }\n\n        # h1 = \"#{reagent_name.sub(/^./, \u0026:upcase)} volume (#{MICROLITERS})\"\n        # h2 = \"Buffer\"\n        # h3 = \"Buffer volume (#{MICROLITERS})\"\n        # h4 = \"Tube label\"\n\n        reagent_table = [[\n            \"#{reagent_name.sub(/^./, \u0026:upcase)}\",\n            \"Volume (#{MICROLITERS})\",\n            \"Buffer\",\n            \"Volume (#{MICROLITERS})\",\n            \"Tube label\"\n        ]]\n\n        ops_by_combo.each do |combo, ops|\n            op = ops[0]\n            row = [\n                op.input(reagent_handle).item.to_s,\n                { content: total_vol(stock_per_rxn, ops.length), check: true },\n                op.input(buffer_handle).sample.name,\n                { content: total_vol(buffer_per_rxn, ops.length), check: true },\n                op.temporary[:modified_buffer]\n            ]\n            reagent_table.append(row)\n        end\n\n        show do\n            # TODO Need to calculate the volume for volumes over 1000 ul\n            title \"Prepare #{reagent_name} dilutions\"\n            note temp_instructions(temperature)\n\n            note \"Dilute the #{ops_by_combo.length \u003e 1 ? reagent_name.pluralize : reagent_name} with buffer according to the table\"\n            note \"Label the tube(s) according to the table\"\n            table reagent_table\n        end\n\n        uniq_items = operations.map { |op| op.input(reagent_handle).item }.uniq\n        release(uniq_items, interactive: true)\n    end\n\n    def total_vol(vol_per_rxn, n_rxns)\n        (vol_per_rxn[:qty] * n_rxns).round\n    end\n\n    def reagent_label(op, reagent_handle, buffer_handle)\n        reagent_name = op.input(reagent_handle).try(:sample).try(:name) || \"unknown\"\n        buffer_name = op.input(buffer_handle).try(:sample).try(:name) || \"unknown\"\n        \"#{reagent_name} in #{buffer_name}\"\n    end\n\n    def add_input_from_item(op, name, item)\n        ft = FieldType.new(\n            name: name,\n            ftype: \"sample\",\n            parent_class: \"OperationType\",\n            parent_id: nil\n        )\n        ft.save\n\n        fv = FieldValue.new(\n            name: name,\n            child_item_id: item.id,\n            child_sample_id: item.sample.id,\n            role: 'input',\n            parent_class: \"Operation\",\n            parent_id: op.id,\n            field_type_id: ft.id\n        )\n        fv.save\n    end\n\n    ########## DEBUG METHODS ##########\n\n    def set_test_labels(items)\n        items.each_with_index do |item, i|\n            item.associate(:sample_tube_label, \"S#{i+1}\")\n        end\n    end\n\n    def set_test_ods(items=[])\n        items = operations.map { |op| op.input(INPUT_YEAST).item } unless items.present?\n        items.uniq.each { |item| item.associate(:od, (2.0 + 3*Random.rand) / 10) }\n    end\n\nend"}},{"library":{"name":"YeastDisplayShows","category":"Yeast Display","code_source":"\nneeds 'Standard Libs/CommonInputOutputNames'\n\nmodule YeastDisplayShows\n    \n    include CommonInputOutputNames\n\n    def prepare_media(container_group, language)\n        flask_type = language[:flask_type]\n        media_volume = language[:media_volume]\n        \n        flask_type = flask_type.pluralize if container_group.length \u003e 1\n        \n        show do\n          title \"Prepare media\"\n          warning \"Work in the media bay for media preparation.\"\n          check \"Grab #{container_group.length} #{flask_type}.\"\n          \n          out_ids = container_group.map { |op| op.output(OUTPUT_YEAST).item.id }.join(\", \")\n          check \"Label each flask or tube with the following ids: #{out_ids}\"\n          \n          note \"Add #{media_volume} of the following media into the #{flask_type}.\"\n          \n          table media_table(container_group)\n        end\n    end\n  \n    def innoculate_flasks(container_group, language)\n        passage_amount = language[:passage_amount]\n        \n        input_type = operations.first.input(INPUT_YEAST).name\n        plural_input_type = operations.length \u003e 1 ? input_type.pluralize : input_type\n        language = language.merge({ input_type: input_type })\n        \n        show do\n          title \"Inoculate #{plural_input_type}\"\n      \n          note passage_amount % language\n          table transfer_table(container_group)\n        end\n    end\n    \n    def media_table(container_group)\n        this_table = container_group.start_table\n        this_table = this_table.custom_column(heading: 'Media') { |op| op.input(\"Media\").sample.name }\n        \n        if container_group.all? { |op| media_volume(op) }\n            this_table = this_table.custom_column(heading: 'Volume (ml)') { |op| media_volume(op).round }\n        end\n        \n        this_table.output_item(OUTPUT_YEAST, checkable: true).end_table\n    end\n    \n    def get_media(container_group)\n        media = container_group.map { |op| op.input(\"Media\").sample.name }.first\n        \n        show do\n            title \"Get media\"\n            \n            check \"Get a bottle of #{media}.\"\n        end\n    end\n    \n    def transfer_table(container_group)\n        this_table = container_group.start_table.input_item(INPUT_YEAST)\n        \n        if container_group.any? { |op| sample_tube_label(op.input(INPUT_YEAST).item) }\n            this_table = this_table.custom_column(heading: 'Tube label') { |op| sample_tube_label(op.input(INPUT_YEAST).item) }\n        end\n        \n        if container_group.all? { |op| transfer_volume(op) }\n            this_table = this_table.custom_column(heading: 'Volume (ml)') { |op| transfer_volume(op).round(1) }\n        end\n        \n        this_table.output_item(OUTPUT_YEAST, checkable: true).end_table\n    end\n    \n    def measure_culture_ods(ops)\n        show do\n            title 'Measure library culture densities.'\n            \n            note 'Use the Nanodrop to measure the density of each yeast culture, and record the OD600.'\n            warning 'Record the OD600 exactly as it is shown on the screen.'\n            \n            table ops.start_table\n                .input_item(INPUT_YEAST)\n                .get(:od, type: 'number', heading: 'OD600')\n                .end_table\n        end\n    end\n  \nend"}}]}